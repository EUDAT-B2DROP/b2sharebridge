{"version":3,"file":"b2sharebridge-filetabmain.js?v=2d504e93c4cc0812050b","mappings":"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","sources":["webpack:///b2sharebridge/webpack/runtime/chunk loaded","webpack:///b2sharebridge/src/components/BridgeDialog.vue?vue&type=style&index=0&id=05cd7f71&lang=css","webpack:///b2sharebridge/src/components/BridgeDialog.vue","webpack://b2sharebridge/./src/components/BridgeDialog.vue?f9c7","webpack://b2sharebridge/./src/components/BridgeDialog.vue?a1da","webpack:///b2sharebridge/src/actions/B2sharebridgeTabOpenAction.js","webpack:///b2sharebridge/src/filetab-main.js","webpack:///b2sharebridge/webpack/bootstrap","webpack:///b2sharebridge/webpack/runtime/compat get default export","webpack:///b2sharebridge/webpack/runtime/define property getters","webpack:///b2sharebridge/webpack/runtime/ensure chunk","webpack:///b2sharebridge/webpack/runtime/global","webpack:///b2sharebridge/webpack/runtime/hasOwnProperty shorthand","webpack:///b2sharebridge/webpack/runtime/make namespace object","webpack:///b2sharebridge/webpack/runtime/runtimeId","webpack:///b2sharebridge/webpack/runtime/publicPath","webpack:///b2sharebridge/webpack/runtime/jsonp chunk loading","webpack:///b2sharebridge/webpack/runtime/nonce","webpack:///b2sharebridge/webpack/startup"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `\n#bridgedial {\n\tmin-width: 60%;\n}\n#bridgedial .select {\n\twidth: 100%;\n}\n#bridgedial .modal__content,\n#infodial .modal__content {\n\tmargin: 50px;\n}\n#bridgedial .modal__content h2,\n#infodial .modal__content h2 {\n\ttext-align: center;\n}\n#bridgedial .form-group,\n#infodial .form-group {\n\tmargin: calc(var(--default-grid-baseline) * 4) 0;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: flex-start;\n}\n#bridgedial .button-container,\n#infodial .button-container {\n\tdisplay: flex;\n\tflex-direction: row;\n\talign-items: start;\n\tjustify-content: flex-end;\n}\n#bridgedial .selecterror div {\n\tborder-color: red;\n}\n#infodial a {\n\tborder-radius: var(--border-radius-pill);\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/BridgeDialog.vue\"],\"names\":[],\"mappings\":\";AAknBA;CACC,cAAc;AACf;AAEA;CACC,WAAW;AACZ;AAEA;;CAEC,YAAY;AACb;AAEA;;CAEC,kBAAkB;AACnB;AAEA;;CAEC,gDAAgD;CAChD,aAAa;CACb,sBAAsB;CACtB,uBAAuB;AACxB;AAEA;;CAEC,aAAa;CACb,mBAAmB;CACnB,kBAAkB;CAClB,yBAAyB;AAC1B;AAEA;CACC,iBAAiB;AAClB;AAEA;CACC,wCAAwC;AACzC\",\"sourcesContent\":[\"<template>\\n\\t<NcModal v-if=\\\"info.message !== ''\\\" id=\\\"infodial\\\" name=\\\"\\\">\\n\\t\\t<div class=\\\"modal__content\\\">\\n\\t\\t\\t<h2>{{ info.heading }}</h2>\\n\\t\\t\\t<p>{{ info.message }}</p>\\n\\t\\t\\t<span class=\\\"button-container\\\">\\n\\t\\t\\t\\t<NcButton\\n\\t\\t\\t\\t\\tv-for=\\\"button in info.buttons\\\"\\n\\t\\t\\t\\t\\t:key=\\\"button.label\\\"\\n\\t\\t\\t\\t\\t:href=\\\"button.href\\\"\\n\\t\\t\\t\\t\\t:type=\\\"button.type\\\"\\n\\t\\t\\t\\t\\t:area-label=\\\"button.label\\\"\\n\\t\\t\\t\\t\\t@click=\\\"button.callback\\\">\\n\\t\\t\\t\\t\\t{{ button.label }}\\n\\t\\t\\t\\t</NcButton>\\n\\t\\t\\t</span>\\n\\t\\t</div>\\n\\t</NcModal>\\n\\t<NcModal v-else-if=\\\"showDialog\\\" id=\\\"bridgedial\\\" name=\\\"\\\">\\n\\t\\t<div class=\\\"modal__content\\\">\\n\\t\\t\\t<h2>Upload data to B2SHARE</h2>\\n\\t\\t\\t<NcSelect\\n\\t\\t\\t\\tv-bind=\\\"modeprops\\\"\\n\\t\\t\\t\\tv-model=\\\"modeprops.value\\\"\\n\\t\\t\\t\\trequired\\n\\t\\t\\t\\t:class=\\\"{ selecterror: modeprops.error }\\\"\\n\\t\\t\\t\\t@update:model-value=\\\"onChangeMode()\\\" />\\n\\t\\t\\t<NcTextField\\n\\t\\t\\t\\tv-if=\\\"!modeprops.value || modeprops.value.id === 'create'\\\"\\n\\t\\t\\t\\tv-model=\\\"title.text\\\"\\n\\t\\t\\t\\tlabel=\\\"Title\\\"\\n\\t\\t\\t\\tplaceholder=\\\"Please enter a title\\\"\\n\\t\\t\\t\\t:disabled=\\\"!modeprops.value\\\"\\n\\t\\t\\t\\t:error=\\\"title.error\\\"\\n\\t\\t\\t\\t:success=\\\"title.success\\\"\\n\\t\\t\\t\\tminlength=\\\"3\\\"\\n\\t\\t\\t\\tmaxlength=\\\"128\\\"\\n\\t\\t\\t\\t:helper-text=\\\"title.helpertext\\\"\\n\\t\\t\\t\\t@update:model-value=\\\"validate\\\">\\n\\t\\t\\t\\t<PencilIcon :size=\\\"20\\\" />\\n\\t\\t\\t</NcTextField>\\n\\t\\t\\t<NcSelect\\n\\t\\t\\t\\tv-bind=\\\"serverprops\\\"\\n\\t\\t\\t\\tv-model=\\\"serverprops.value\\\"\\n\\t\\t\\t\\trequired\\n\\t\\t\\t\\t:class=\\\"{ selecterror: serverprops.error }\\\"\\n\\t\\t\\t\\t@update:model-value=\\\"onChangeServer\\\" />\\n\\t\\t\\t<NcSelect\\n\\t\\t\\t\\tv-if=\\\"modeprops.value && modeprops.value.id === 'attach'\\\"\\n\\t\\t\\t\\tv-bind=\\\"depositselectprops\\\"\\n\\t\\t\\t\\tv-model=\\\"depositselectprops.value\\\"\\n\\t\\t\\t\\trequired\\n\\t\\t\\t\\t:class=\\\"{ selecterror: depositselectprops.error }\\\"\\n\\t\\t\\t\\t@update:model-value=\\\"validate\\\" />\\n\\t\\t\\t<NcSelect\\n\\t\\t\\t\\tv-if=\\\"!modeprops.value || modeprops.value.id === 'create'\\\"\\n\\t\\t\\t\\tv-bind=\\\"communityprops\\\"\\n\\t\\t\\t\\tv-model=\\\"communityprops.value\\\"\\n\\t\\t\\t\\t:disabled=\\\"!modeprops.value\\\"\\n\\t\\t\\t\\trequired\\n\\t\\t\\t\\t:class=\\\"{ selecterror: communityprops.error }\\\"\\n\\t\\t\\t\\t@update:model-value=\\\"validate\\\" />\\n\\t\\t\\t<NcCheckboxRadioSwitch\\n\\t\\t\\t\\tv-if=\\\"!modeprops.value || modeprops.value.id === 'create'\\\"\\n\\t\\t\\t\\tv-model=\\\"openAccess\\\"\\n\\t\\t\\t\\t:disabled=\\\"!modeprops.value\\\">\\n\\t\\t\\t\\tOpen Access\\n\\t\\t\\t</NcCheckboxRadioSwitch>\\n\\t\\t\\t<span class=\\\"button-container\\\">\\n\\t\\t\\t\\t<NcButton aria-label=\\\"close\\\" @click=\\\"closeModal\\\">\\n\\t\\t\\t\\t\\tCancel\\n\\t\\t\\t\\t</NcButton>\\n\\t\\t\\t\\t<NcButton\\n\\t\\t\\t\\t\\t:disabled=\\\"publish.disabled || publish.publishing\\\"\\n\\t\\t\\t\\t\\tvariant=\\\"primary\\\"\\n\\t\\t\\t\\t\\taria-label=\\\"publish\\\"\\n\\t\\t\\t\\t\\t@click=\\\"createDeposit\\\">\\n\\t\\t\\t\\t\\t{{ getPublishLabel() }}\\n\\t\\t\\t\\t</NcButton>\\n\\t\\t\\t</span>\\n\\t\\t\\t<NcProgressBar v-if=\\\"publish.publishTime\\\" :value=\\\"progress\\\" size=\\\"medium\\\" />\\n\\t\\t</div>\\n\\t</NcModal>\\n</template>\\n\\n<script>\\nimport axios from '@nextcloud/axios'\\nimport { generateUrl } from '@nextcloud/router'\\nimport { NcButton, NcCheckboxRadioSwitch, NcModal, NcProgressBar, NcSelect, NcTextField } from '@nextcloud/vue'\\nimport PencilIcon from 'vue-material-design-icons/Pencil.vue'\\n\\nexport default {\\n\\tname: 'BridgeDialog',\\n\\tcomponents: {\\n\\t\\tNcModal,\\n\\t\\tNcTextField,\\n\\t\\tNcSelect,\\n\\t\\tNcCheckboxRadioSwitch,\\n\\t\\tNcButton,\\n\\t\\tNcProgressBar,\\n\\t\\tPencilIcon,\\n\\t},\\n\\n\\tprops: {\\n\\t\\tselectedFiles: {\\n\\t\\t\\ttype: Array,\\n\\t\\t\\trequired: true,\\n\\t\\t},\\n\\t},\\n\\n\\tdata() {\\n\\t\\treturn {\\n\\t\\t\\tshowDialog: false,\\n\\t\\t\\tpublish: {\\n\\t\\t\\t\\tdisabled: true,\\n\\t\\t\\t\\tpublishing: false,\\n\\t\\t\\t\\tpublishTime: null,\\n\\t\\t\\t\\tpressedOnce: false,\\n\\t\\t\\t},\\n\\n\\t\\t\\ttitle: {\\n\\t\\t\\t\\tsuccess: false,\\n\\t\\t\\t\\terror: false,\\n\\t\\t\\t\\ttext: '',\\n\\t\\t\\t\\thelpertext: '',\\n\\t\\t\\t},\\n\\n\\t\\t\\tserverprops: {\\n\\t\\t\\t\\tinputLabel: 'Server',\\n\\t\\t\\t\\toptions: [],\\n\\t\\t\\t\\tvalue: null,\\n\\t\\t\\t\\terror: false,\\n\\t\\t\\t},\\n\\n\\t\\t\\tmodeprops: {\\n\\t\\t\\t\\tinputLabel: 'Mode',\\n\\t\\t\\t\\toptions: [\\n\\t\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\tid: 'create',\\n\\t\\t\\t\\t\\t\\tlabel: 'Create a new draft',\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\tid: 'attach',\\n\\t\\t\\t\\t\\t\\tlabel: 'Attach to existing draft',\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t],\\n\\n\\t\\t\\t\\tvalue: null,\\n\\t\\t\\t\\terror: false,\\n\\t\\t\\t},\\n\\n\\t\\t\\tdepositselectprops: {\\n\\t\\t\\t\\tinputLabel: 'Select Draft',\\n\\t\\t\\t\\toptions: [],\\n\\t\\t\\t\\tdeposits: null,\\n\\t\\t\\t\\tvalue: null,\\n\\t\\t\\t\\terror: false,\\n\\t\\t\\t},\\n\\n\\t\\t\\tcommunityprops: {\\n\\t\\t\\t\\tinputLabel: 'Community',\\n\\t\\t\\t\\toptions: [],\\n\\t\\t\\t\\tvalue: null,\\n\\t\\t\\t\\terror: false,\\n\\t\\t\\t},\\n\\n\\t\\t\\topenAccess: false,\\n\\t\\t\\tinfo: {\\n\\t\\t\\t\\theading: 'Error',\\n\\t\\t\\t\\tmessage: '',\\n\\t\\t\\t\\tbuttons: [\\n\\t\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\tlabel: 'Ok',\\n\\t\\t\\t\\t\\t\\ttype: 'error',\\n\\t\\t\\t\\t\\t\\tcallback: () => (this.closeModal()),\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t],\\n\\t\\t\\t},\\n\\n\\t\\t\\t// Technical fields\\n\\t\\t\\ttokens: [],\\n\\t\\t\\tservers: [],\\n\\t\\t\\tprogress: 0, // progress bar\\n\\t\\t}\\n\\t},\\n\\n\\tasync mounted() {\\n\\t\\tconst serverPromise = this.loadServers()\\n\\t\\tconst communityPromise = this.loadCommunities()\\n\\t\\tconst tokenPromise = this.loadTokens()\\n\\t\\tawait serverPromise\\n\\t\\tawait communityPromise\\n\\t\\tawait tokenPromise\\n\\n\\t\\tif (!this.hasValidTokens()) {\\n\\t\\t\\tthis.tokens = null\\n\\t\\t\\tthis.info.heading = 'You are missing a token!'\\n\\t\\t\\tthis.info.message = 'Please set your B2SHARE API token.' // <a class=\\\"bridgelink\\\" href=\\\"/settings/user/b2sharebridge\\\">here</a>'\\n\\t\\t\\t// this.showDialog = true\\n\\t\\t\\tthis.info.buttons = [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\tlabel: 'Cancel',\\n\\t\\t\\t\\t\\ttype: 'secondary',\\n\\t\\t\\t\\t\\tcallback: () => (this.closeModal()),\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\tlabel: 'Set API Token',\\n\\t\\t\\t\\t\\ttype: 'primary',\\n\\t\\t\\t\\t\\tcallback: () => (this.redirect('/settings/user/b2sharebridge')),\\n\\t\\t\\t\\t\\thref: generateUrl('/settings/user/b2sharebridge'),\\n\\t\\t\\t\\t},\\n\\t\\t\\t]\\n\\t\\t\\treturn\\n\\t\\t}\\n\\n\\t\\tif (this.servers.length !== Object.keys(this.tokens).length) {\\n\\t\\t\\tthis.info.message = 'Number of servers and tokens differ, please contact an administrator'\\n\\t\\t\\tconsole.error(this.info.message)\\n\\t\\t\\tthis.tokens = null\\n\\t\\t\\t// this.showDialog = true\\n\\t\\t\\treturn\\n\\t\\t}\\n\\n\\t\\tif (this.servers.length !== 0) {\\n\\t\\t\\tthis.servers.forEach((server) => {\\n\\t\\t\\t\\tconst hasToken = this.tokens[server.id] !== ''\\n\\t\\t\\t\\tif (hasToken) {\\n\\t\\t\\t\\t\\tconst serverOption = {\\n\\t\\t\\t\\t\\t\\tid: server.id,\\n\\t\\t\\t\\t\\t\\tlabel: server.name,\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tthis.serverprops.options.push(serverOption)\\n\\t\\t\\t\\t\\tif (this.serverprops.value === null) {\\n\\t\\t\\t\\t\\t\\tconsole.debug('Selected server automatically')\\n\\t\\t\\t\\t\\t\\tthis.serverprops.value = serverOption\\n\\t\\t\\t\\t\\t\\tthis.onChangeServer() // update communities\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}\\n\\t\\t\\t})\\n\\t\\t}\\n\\n\\t\\t// add progress bar timer running indefinately\\n\\t\\tsetInterval(this.updateProgressBar, 1000)\\n\\n\\t\\tthis.showDialog = true\\n\\t},\\n\\n\\tmethods: {\\n\\t\\t// API stuff\\n\\t\\tasync loadServers() {\\n\\t\\t\\tconst urlPath\\n\\t\\t\\t\\t= '/apps/b2sharebridge/servers?requesttoken='\\n\\t\\t\\t\\t\\t+ encodeURIComponent(OC.requestToken)\\n\\n\\t\\t\\treturn axios\\n\\t\\t\\t\\t.get(generateUrl(urlPath))\\n\\t\\t\\t\\t.then((response) => {\\n\\t\\t\\t\\t\\tconsole.debug('Loaded servers:')\\n\\t\\t\\t\\t\\tconsole.debug(response)\\n\\t\\t\\t\\t\\tthis.servers = response.data\\n\\t\\t\\t\\t})\\n\\t\\t\\t\\t.catch((error) => {\\n\\t\\t\\t\\t\\tthis.info.message = 'Fetching B2SHARE servers failed! Please check your connection or contact an administrator!'\\n\\t\\t\\t\\t\\tconsole.error(this.info.message)\\n\\t\\t\\t\\t\\tconsole.error(error)\\n\\t\\t\\t\\t})\\n\\t\\t},\\n\\n\\t\\tasync loadCommunities() {\\n\\t\\t\\tconst urlPath\\n\\t\\t\\t\\t= '/apps/b2sharebridge/gettabviewcontent?requesttoken='\\n\\t\\t\\t\\t\\t+ encodeURIComponent(OC.requestToken)\\n\\n\\t\\t\\treturn axios\\n\\t\\t\\t\\t.get(generateUrl(urlPath))\\n\\t\\t\\t\\t.then((response) => {\\n\\t\\t\\t\\t\\tconsole.debug('Loaded communities:')\\n\\t\\t\\t\\t\\tconsole.debug(response)\\n\\t\\t\\t\\t\\tthis.communities = response.data\\n\\t\\t\\t\\t})\\n\\t\\t\\t\\t.catch((error) => {\\n\\t\\t\\t\\t\\tthis.info.message = 'Fetching B2SHARE communities failed! Please check your connection or contact an administrator!'\\n\\t\\t\\t\\t\\tconsole.error(this.info.message)\\n\\t\\t\\t\\t\\tconsole.error(error)\\n\\t\\t\\t\\t})\\n\\t\\t},\\n\\n\\t\\tasync loadTokens() {\\n\\t\\t\\tconst urlPath\\n\\t\\t\\t\\t= '/apps/b2sharebridge/apitoken?requesttoken='\\n\\t\\t\\t\\t\\t+ encodeURIComponent(OC.requestToken)\\n\\n\\t\\t\\treturn axios\\n\\t\\t\\t\\t.get(generateUrl(urlPath))\\n\\t\\t\\t\\t.then((response) => {\\n\\t\\t\\t\\t\\tconsole.debug('Successfully requested tokens!')\\n\\t\\t\\t\\t\\tconsole.debug(response.data)\\n\\t\\t\\t\\t\\tif (response.data) {\\n\\t\\t\\t\\t\\t\\tthis.tokens = response.data\\n\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\tconsole.info('No token set!')\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t})\\n\\t\\t\\t\\t.catch((error) => {\\n\\t\\t\\t\\t\\tthis.info.message = 'Fetching tokens failed! Please check your connection or contact an administrator!'\\n\\t\\t\\t\\t\\tconsole.error(this.info.message)\\n\\t\\t\\t\\t\\tconsole.error(error)\\n\\t\\t\\t\\t})\\n\\t\\t},\\n\\n\\t\\tupdateDepositList() {\\n\\t\\t\\tif (this.serverprops?.value?.id && this.depositselectprops?.deposits?.[this.serverprops.value.id]?.hits) {\\n\\t\\t\\t\\tthis.depositselectprops.options = []\\n\\t\\t\\t\\tconst deposits = this.depositselectprops.deposits[this.serverprops.value.id].hits\\n\\t\\t\\t\\tdeposits.forEach((deposit) => {\\n\\t\\t\\t\\t\\tconst depositOption = {\\n\\t\\t\\t\\t\\t\\tid: deposit.id,\\n\\t\\t\\t\\t\\t\\tlabel: deposit.metadata.titles?.[0]?.title ?? deposit.metadata.title,\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tthis.depositselectprops.options.push(depositOption)\\n\\t\\t\\t\\t})\\n\\t\\t\\t}\\n\\t\\t},\\n\\n\\t\\t// Events\\n\\t\\tonChangeServer() {\\n\\t\\t\\tconsole.debug('Updating community options')\\n\\n\\t\\t\\t// reset communityprops\\n\\t\\t\\tthis.communityprops.options = []\\n\\t\\t\\tthis.communityprops.value = null\\n\\n\\t\\t\\tif (this.serverprops.value !== null) {\\n\\t\\t\\t\\t// set communities for new server\\n\\t\\t\\t\\tthis.communities.forEach((community, _index) => {\\n\\t\\t\\t\\t\\tif (Object.hasOwn(community, 'serverId') && parseInt(community.serverId) === parseInt(this.serverprops.value.id)) {\\n\\t\\t\\t\\t\\t\\tconst communityOption = {\\n\\t\\t\\t\\t\\t\\t\\tid: community.id,\\n\\t\\t\\t\\t\\t\\t\\tlabel: community.name,\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\tthis.communityprops.options.push(communityOption)\\n\\t\\t\\t\\t\\t\\tif (community.name === 'EUDAT') { // TODO make this configurable\\n\\t\\t\\t\\t\\t\\t\\tconsole.debug('Automatically selected EUDAT as community')\\n\\t\\t\\t\\t\\t\\t\\tthis.communityprops.value = communityOption\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t})\\n\\n\\t\\t\\t\\t// update deposit list in attach mode\\n\\t\\t\\t\\tthis.updateDepositList()\\n\\t\\t\\t}\\n\\t\\t\\tthis.validate()\\n\\t\\t},\\n\\n\\t\\tonChangeMode() {\\n\\t\\t\\tconsole.debug('Updating b2share draft list')\\n\\n\\t\\t\\tif (!this.depositselectprops.deposits) {\\n\\t\\t\\t\\tthis.fetchAllDrafts()\\n\\t\\t\\t}\\n\\n\\t\\t\\tthis.validate()\\n\\t\\t},\\n\\n\\t\\tasync fetchAllDrafts() {\\n\\t\\t\\tconst size = 50\\n\\n\\t\\t\\t/**\\n\\t\\t\\t *\\n\\t\\t\\t * @param {int} page Page number\\n\\t\\t\\t */\\n\\t\\t\\tfunction createUrl(page) {\\n\\t\\t\\t\\tconst urlArr = [\\n\\t\\t\\t\\t\\t'/apps/b2sharebridge/publications?draft=',\\n\\t\\t\\t\\t\\ttrue,\\n\\t\\t\\t\\t\\t'&page=',\\n\\t\\t\\t\\t\\tpage,\\n\\t\\t\\t\\t\\t'&size=',\\n\\t\\t\\t\\t\\tsize,\\n\\t\\t\\t\\t\\t'&requesttoken=',\\n\\t\\t\\t\\t\\tencodeURIComponent(OC.requestToken),\\n\\t\\t\\t\\t]\\n\\t\\t\\t\\treturn generateUrl(urlArr.join(''))\\n\\t\\t\\t}\\n\\n\\t\\t\\t// catch the first result and calculate if more are needed\\n\\t\\t\\tconst depositData = {}\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tconst firstRes = await axios.get(createUrl(1))\\n\\t\\t\\t\\tconst servers = Object.keys(firstRes.data)\\n\\t\\t\\t\\tlet totalNumber = 0\\n\\t\\t\\t\\tfor (const server of servers) {\\n\\t\\t\\t\\t\\tconst total = firstRes.data[server].total\\n\\t\\t\\t\\t\\tif (total > totalNumber) {\\n\\t\\t\\t\\t\\t\\ttotalNumber = total\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tconst serverData = {\\n\\t\\t\\t\\t\\t\\thits: firstRes.data[server].records.hits,\\n\\t\\t\\t\\t\\t\\ttotal,\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tdepositData[server] = serverData\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t// catch other results\\n\\t\\t\\t\\tif (totalNumber > size) {\\n\\t\\t\\t\\t\\t// promises\\n\\t\\t\\t\\t\\tconst requests = []\\n\\t\\t\\t\\t\\tfor (let page = 2; (page - 1) * size < totalNumber; page++) {\\n\\t\\t\\t\\t\\t\\trequests.push(axios.get(createUrl(page)))\\n\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\tconst responses = await Promise.all(requests)\\n\\n\\t\\t\\t\\t\\t// append missing deposits\\n\\t\\t\\t\\t\\tfor (const res of responses) {\\n\\t\\t\\t\\t\\t\\tfor (const server of servers) {\\n\\t\\t\\t\\t\\t\\t\\tdepositData[server].hits.push(...res.data[server].records.hits)\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}\\n\\t\\t\\t} catch (_error) {\\n\\t\\t\\t\\tconsole.error('Could not fetch deposits')\\n\\t\\t\\t\\treturn\\n\\t\\t\\t}\\n\\n\\t\\t\\t// save results\\n\\t\\t\\tthis.depositselectprops.deposits = depositData\\n\\n\\t\\t\\t// update deposit list\\n\\t\\t\\tthis.updateDepositList()\\n\\t\\t},\\n\\n\\t\\thasValidTokens() {\\n\\t\\t\\tif (this.tokens === null) {\\n\\t\\t\\t\\treturn false\\n\\t\\t\\t}\\n\\t\\t\\tlet validTokenFound = false\\n\\t\\t\\tObject.keys(this.tokens).forEach((key) => {\\n\\t\\t\\t\\tif (this.tokens[key] !== '') {\\n\\t\\t\\t\\t\\tvalidTokenFound = true\\n\\t\\t\\t\\t}\\n\\t\\t\\t})\\n\\t\\t\\treturn validTokenFound\\n\\t\\t},\\n\\n\\t\\tvalidate(_event) {\\n\\t\\t\\tlet isValid = true\\n\\t\\t\\tthis.title.error = false\\n\\t\\t\\tthis.title.helpertext = ''\\n\\t\\t\\tthis.serverprops.error = false\\n\\t\\t\\tthis.communityprops.error = false\\n\\t\\t\\tthis.modeprops.error = false\\n\\t\\t\\tthis.depositselectprops.error = false\\n\\n\\t\\t\\t// run checks\\n\\t\\t\\t// check server\\n\\t\\t\\tif (this.serverprops.value === null) {\\n\\t\\t\\t\\tisValid = false\\n\\t\\t\\t\\tif (this.publish.pressedOnce) {\\n\\t\\t\\t\\t\\tthis.serverprops.error = true\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\n\\t\\t\\t// check mode\\n\\t\\t\\tif (this.modeprops.value === null) {\\n\\t\\t\\t\\tisValid = false\\n\\t\\t\\t\\tif (this.publish.pressedOnce) {\\n\\t\\t\\t\\t\\tthis.modeprops.error = true\\n\\t\\t\\t\\t}\\n\\t\\t\\t} else if (this.modeprops.value.id === 'attach') {\\n\\t\\t\\t\\t// mode attach: check deposit selected\\n\\t\\t\\t\\tif (this.depositselectprops.value === null) {\\n\\t\\t\\t\\t\\tisValid = false\\n\\t\\t\\t\\t\\tif (this.publish.pressedOnce) {\\n\\t\\t\\t\\t\\t\\tthis.depositselectprops.error = true\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}\\n\\t\\t\\t} else if (this.modeprops.value.id === 'create') {\\n\\t\\t\\t\\t// mode create: check community\\n\\t\\t\\t\\tif (this.communityprops.value === null) {\\n\\t\\t\\t\\t\\tisValid = false\\n\\t\\t\\t\\t\\tif (this.publish.pressedOnce) {\\n\\t\\t\\t\\t\\t\\tthis.communityprops.error = true\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t// mode create: check title\\n\\t\\t\\t\\tif (this.title.text.length <= 3 || this.title.text.length > 128) {\\n\\t\\t\\t\\t\\tisValid = false\\n\\t\\t\\t\\t\\tthis.title.success = false\\n\\t\\t\\t\\t\\tif (this.publish.pressedOnce) {\\n\\t\\t\\t\\t\\t\\t// Note both can be false\\n\\t\\t\\t\\t\\t\\tthis.title.error = true\\n\\t\\t\\t\\t\\t\\tthis.title.helpertext = 'Please set a title with a length between 3 and 128 characters'\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tthis.title.error = false\\n\\t\\t\\t\\t\\tthis.title.success = true\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\n\\t\\t\\t// Change publishable with validation\\n\\t\\t\\tthis.publish.disabled = !isValid\\n\\t\\t\\treturn isValid\\n\\t\\t},\\n\\n\\t\\tasync createDeposit() {\\n\\t\\t\\t// validate inputs only after first press\\n\\t\\t\\tthis.publish.pressedOnce = true\\n\\t\\t\\tif (!this.validate()) {\\n\\t\\t\\t\\treturn\\n\\t\\t\\t}\\n\\n\\t\\t\\tif (!this.selectedFiles.length) {\\n\\t\\t\\t\\tconsole.error('No files selected')\\n\\t\\t\\t\\treturn\\n\\t\\t\\t}\\n\\n\\t\\t\\t// update progress bar\\n\\t\\t\\tthis.publish.publishTime = Date.now()\\n\\t\\t\\tthis.publish.publishing = true\\n\\n\\t\\t\\tlet url = ''\\n\\t\\t\\tlet props = {}\\n\\t\\t\\tif (this.modeprops.value.id === 'attach') {\\n\\t\\t\\t\\t/* const draft = this.getCurrentDraft() */\\n\\t\\t\\t\\turl = '/apps/b2sharebridge/attach'\\n\\t\\t\\t\\tprops = {\\n\\t\\t\\t\\t\\tids: this.selectedFiles,\\n\\t\\t\\t\\t\\tdraftId: this.depositselectprops.value.id,\\n\\t\\t\\t\\t\\tserver_id: this.serverprops.value.id,\\n\\t\\t\\t\\t}\\n\\t\\t\\t} else if (this.modeprops.value.id === 'create') {\\n\\t\\t\\t\\turl = '/apps/b2sharebridge/publish'\\n\\t\\t\\t\\tprops = {\\n\\t\\t\\t\\t\\tids: this.selectedFiles,\\n\\t\\t\\t\\t\\tcommunity: this.communityprops.value.id,\\n\\t\\t\\t\\t\\topen_access: this.openAccess,\\n\\t\\t\\t\\t\\ttitle: this.title.text,\\n\\t\\t\\t\\t\\tserver_id: this.serverprops.value.id,\\n\\t\\t\\t\\t}\\n\\t\\t\\t} else {\\n\\t\\t\\t\\treturn\\n\\t\\t\\t}\\n\\t\\t\\taxios\\n\\t\\t\\t\\t.post(\\n\\t\\t\\t\\t\\tgenerateUrl(url),\\n\\t\\t\\t\\t\\tprops,\\n\\t\\t\\t\\t)\\n\\t\\t\\t\\t.then((response) => {\\n\\t\\t\\t\\t\\tconsole.debug(response)\\n\\t\\t\\t\\t\\tthis.info.heading = 'Transferring to B2SHARE'\\n\\t\\t\\t\\t\\tthis.info.message = response.data.message\\n\\t\\t\\t\\t\\tthis.info.buttons = [\\n\\t\\t\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\t\\tlabel: 'Ok',\\n\\t\\t\\t\\t\\t\\t\\ttype: 'secondary',\\n\\t\\t\\t\\t\\t\\t\\tcallback: () => (this.closeModal()),\\n\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\t\\tlabel: 'Show Deposit',\\n\\t\\t\\t\\t\\t\\t\\ttype: 'primary',\\n\\t\\t\\t\\t\\t\\t\\tcallback: () => (this.redirect('/apps/b2sharebridge/?uploads')),\\n\\t\\t\\t\\t\\t\\t\\thref: generateUrl('/apps/b2sharebridge/?uploads'),\\n\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t]\\n\\t\\t\\t\\t\\tthis.publish.publishing = false\\n\\t\\t\\t\\t\\tthis.publish.publishTime = null\\n\\t\\t\\t\\t})\\n\\t\\t\\t\\t.catch((error) => {\\n\\t\\t\\t\\t\\tif (error.response) {\\n\\t\\t\\t\\t\\t\\tif (error.response.status === 413) { // entity too large\\n\\t\\t\\t\\t\\t\\t\\tthis.info.message = 'Publishing failed! One or more of your files are too large!'\\n\\t\\t\\t\\t\\t\\t} else if (error.response.status === 429) { // too many uploads\\n\\t\\t\\t\\t\\t\\t\\tthis.info.message = 'Publishing failed! You have too many pending uploads, please try again later!'\\n\\t\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\t\\tthis.info.message = 'Publishing failed! Please check your connection or contact an administrator!'\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\tconsole.error(this.info.message)\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tconsole.error(error)\\n\\t\\t\\t\\t\\tthis.publish.publishing = false\\n\\t\\t\\t\\t\\tthis.publish.publishTime = null\\n\\t\\t\\t\\t})\\n\\t\\t},\\n\\n\\t\\tcloseModal() {\\n\\t\\t\\tthis.showDialog = false\\n\\t\\t\\tthis.info.message = ''\\n\\t\\t},\\n\\n\\t\\tupdateProgressBar() {\\n\\t\\t\\tif (!this.publish.publishTime) {\\n\\t\\t\\t\\treturn\\n\\t\\t\\t}\\n\\t\\t\\tconst seconds = (Date.now() - this.publish.publishTime) / 1000.0\\n\\t\\t\\tconsole.debug(seconds)\\n\\t\\t\\tthis.progress = Math.max(Math.min(Math.round(seconds * 20), 99), 10)\\n\\t\\t},\\n\\n\\t\\tgetPublishLabel() {\\n\\t\\t\\tif (!this.modeprops.value || this.modeprops.value.id === 'create') {\\n\\t\\t\\t\\treturn 'Publish'\\n\\t\\t\\t} else if (this.modeprops.value.id === 'attach') {\\n\\t\\t\\t\\treturn 'Attach'\\n\\t\\t\\t} else {\\n\\t\\t\\t\\tconsole.error('Unknown mode, please tell an administrator')\\n\\t\\t\\t\\treturn 'Unknown'\\n\\t\\t\\t}\\n\\t\\t},\\n\\n\\t\\tredirect(url) {\\n\\t\\t\\tthis.$router.push(generateUrl(url))\\n\\t\\t},\\n\\n\\t\\t/* getCurrentDraft() {\\n\\t\\t\\tif (this.serverprops.value && this.depositselectprops.value) {\\n\\t\\t\\t\\treturn this.depositselectprops.deposits[this.serverprops.value.id].hits.find((deposit) => deposit.id === this.depositselectprops.value.id)\\n\\t\\t\\t}\\n\\t\\t\\treturn null\\n\\t\\t}, */\\n\\t},\\n}\\n</script>\\n\\n<style>\\n#bridgedial {\\n\\tmin-width: 60%;\\n}\\n\\n#bridgedial .select {\\n\\twidth: 100%;\\n}\\n\\n#bridgedial .modal__content,\\n#infodial .modal__content {\\n\\tmargin: 50px;\\n}\\n\\n#bridgedial .modal__content h2,\\n#infodial .modal__content h2 {\\n\\ttext-align: center;\\n}\\n\\n#bridgedial .form-group,\\n#infodial .form-group {\\n\\tmargin: calc(var(--default-grid-baseline) * 4) 0;\\n\\tdisplay: flex;\\n\\tflex-direction: column;\\n\\talign-items: flex-start;\\n}\\n\\n#bridgedial .button-container,\\n#infodial .button-container {\\n\\tdisplay: flex;\\n\\tflex-direction: row;\\n\\talign-items: start;\\n\\tjustify-content: flex-end;\\n}\\n\\n#bridgedial .selecterror div {\\n\\tborder-color: red;\\n}\\n\\n#infodial a {\\n\\tborder-radius: var(--border-radius-pill);\\n}\\n</style>\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","<template>\n\t<NcModal v-if=\"info.message !== ''\" id=\"infodial\" name=\"\">\n\t\t<div class=\"modal__content\">\n\t\t\t<h2>{{ info.heading }}</h2>\n\t\t\t<p>{{ info.message }}</p>\n\t\t\t<span class=\"button-container\">\n\t\t\t\t<NcButton\n\t\t\t\t\tv-for=\"button in info.buttons\"\n\t\t\t\t\t:key=\"button.label\"\n\t\t\t\t\t:href=\"button.href\"\n\t\t\t\t\t:type=\"button.type\"\n\t\t\t\t\t:area-label=\"button.label\"\n\t\t\t\t\t@click=\"button.callback\">\n\t\t\t\t\t{{ button.label }}\n\t\t\t\t</NcButton>\n\t\t\t</span>\n\t\t</div>\n\t</NcModal>\n\t<NcModal v-else-if=\"showDialog\" id=\"bridgedial\" name=\"\">\n\t\t<div class=\"modal__content\">\n\t\t\t<h2>Upload data to B2SHARE</h2>\n\t\t\t<NcSelect\n\t\t\t\tv-bind=\"modeprops\"\n\t\t\t\tv-model=\"modeprops.value\"\n\t\t\t\trequired\n\t\t\t\t:class=\"{ selecterror: modeprops.error }\"\n\t\t\t\t@update:model-value=\"onChangeMode()\" />\n\t\t\t<NcTextField\n\t\t\t\tv-if=\"!modeprops.value || modeprops.value.id === 'create'\"\n\t\t\t\tv-model=\"title.text\"\n\t\t\t\tlabel=\"Title\"\n\t\t\t\tplaceholder=\"Please enter a title\"\n\t\t\t\t:disabled=\"!modeprops.value\"\n\t\t\t\t:error=\"title.error\"\n\t\t\t\t:success=\"title.success\"\n\t\t\t\tminlength=\"3\"\n\t\t\t\tmaxlength=\"128\"\n\t\t\t\t:helper-text=\"title.helpertext\"\n\t\t\t\t@update:model-value=\"validate\">\n\t\t\t\t<PencilIcon :size=\"20\" />\n\t\t\t</NcTextField>\n\t\t\t<NcSelect\n\t\t\t\tv-bind=\"serverprops\"\n\t\t\t\tv-model=\"serverprops.value\"\n\t\t\t\trequired\n\t\t\t\t:class=\"{ selecterror: serverprops.error }\"\n\t\t\t\t@update:model-value=\"onChangeServer\" />\n\t\t\t<NcSelect\n\t\t\t\tv-if=\"modeprops.value && modeprops.value.id === 'attach'\"\n\t\t\t\tv-bind=\"depositselectprops\"\n\t\t\t\tv-model=\"depositselectprops.value\"\n\t\t\t\trequired\n\t\t\t\t:class=\"{ selecterror: depositselectprops.error }\"\n\t\t\t\t@update:model-value=\"validate\" />\n\t\t\t<NcSelect\n\t\t\t\tv-if=\"!modeprops.value || modeprops.value.id === 'create'\"\n\t\t\t\tv-bind=\"communityprops\"\n\t\t\t\tv-model=\"communityprops.value\"\n\t\t\t\t:disabled=\"!modeprops.value\"\n\t\t\t\trequired\n\t\t\t\t:class=\"{ selecterror: communityprops.error }\"\n\t\t\t\t@update:model-value=\"validate\" />\n\t\t\t<NcCheckboxRadioSwitch\n\t\t\t\tv-if=\"!modeprops.value || modeprops.value.id === 'create'\"\n\t\t\t\tv-model=\"openAccess\"\n\t\t\t\t:disabled=\"!modeprops.value\">\n\t\t\t\tOpen Access\n\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t<span class=\"button-container\">\n\t\t\t\t<NcButton aria-label=\"close\" @click=\"closeModal\">\n\t\t\t\t\tCancel\n\t\t\t\t</NcButton>\n\t\t\t\t<NcButton\n\t\t\t\t\t:disabled=\"publish.disabled || publish.publishing\"\n\t\t\t\t\tvariant=\"primary\"\n\t\t\t\t\taria-label=\"publish\"\n\t\t\t\t\t@click=\"createDeposit\">\n\t\t\t\t\t{{ getPublishLabel() }}\n\t\t\t\t</NcButton>\n\t\t\t</span>\n\t\t\t<NcProgressBar v-if=\"publish.publishTime\" :value=\"progress\" size=\"medium\" />\n\t\t</div>\n\t</NcModal>\n</template>\n\n<script>\nimport axios from '@nextcloud/axios'\nimport { generateUrl } from '@nextcloud/router'\nimport { NcButton, NcCheckboxRadioSwitch, NcModal, NcProgressBar, NcSelect, NcTextField } from '@nextcloud/vue'\nimport PencilIcon from 'vue-material-design-icons/Pencil.vue'\n\nexport default {\n\tname: 'BridgeDialog',\n\tcomponents: {\n\t\tNcModal,\n\t\tNcTextField,\n\t\tNcSelect,\n\t\tNcCheckboxRadioSwitch,\n\t\tNcButton,\n\t\tNcProgressBar,\n\t\tPencilIcon,\n\t},\n\n\tprops: {\n\t\tselectedFiles: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tshowDialog: false,\n\t\t\tpublish: {\n\t\t\t\tdisabled: true,\n\t\t\t\tpublishing: false,\n\t\t\t\tpublishTime: null,\n\t\t\t\tpressedOnce: false,\n\t\t\t},\n\n\t\t\ttitle: {\n\t\t\t\tsuccess: false,\n\t\t\t\terror: false,\n\t\t\t\ttext: '',\n\t\t\t\thelpertext: '',\n\t\t\t},\n\n\t\t\tserverprops: {\n\t\t\t\tinputLabel: 'Server',\n\t\t\t\toptions: [],\n\t\t\t\tvalue: null,\n\t\t\t\terror: false,\n\t\t\t},\n\n\t\t\tmodeprops: {\n\t\t\t\tinputLabel: 'Mode',\n\t\t\t\toptions: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'create',\n\t\t\t\t\t\tlabel: 'Create a new draft',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'attach',\n\t\t\t\t\t\tlabel: 'Attach to existing draft',\n\t\t\t\t\t},\n\t\t\t\t],\n\n\t\t\t\tvalue: null,\n\t\t\t\terror: false,\n\t\t\t},\n\n\t\t\tdepositselectprops: {\n\t\t\t\tinputLabel: 'Select Draft',\n\t\t\t\toptions: [],\n\t\t\t\tdeposits: null,\n\t\t\t\tvalue: null,\n\t\t\t\terror: false,\n\t\t\t},\n\n\t\t\tcommunityprops: {\n\t\t\t\tinputLabel: 'Community',\n\t\t\t\toptions: [],\n\t\t\t\tvalue: null,\n\t\t\t\terror: false,\n\t\t\t},\n\n\t\t\topenAccess: false,\n\t\t\tinfo: {\n\t\t\t\theading: 'Error',\n\t\t\t\tmessage: '',\n\t\t\t\tbuttons: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Ok',\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\tcallback: () => (this.closeModal()),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\n\t\t\t// Technical fields\n\t\t\ttokens: [],\n\t\t\tservers: [],\n\t\t\tprogress: 0, // progress bar\n\t\t}\n\t},\n\n\tasync mounted() {\n\t\tconst serverPromise = this.loadServers()\n\t\tconst communityPromise = this.loadCommunities()\n\t\tconst tokenPromise = this.loadTokens()\n\t\tawait serverPromise\n\t\tawait communityPromise\n\t\tawait tokenPromise\n\n\t\tif (!this.hasValidTokens()) {\n\t\t\tthis.tokens = null\n\t\t\tthis.info.heading = 'You are missing a token!'\n\t\t\tthis.info.message = 'Please set your B2SHARE API token.' // <a class=\"bridgelink\" href=\"/settings/user/b2sharebridge\">here</a>'\n\t\t\t// this.showDialog = true\n\t\t\tthis.info.buttons = [\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Cancel',\n\t\t\t\t\ttype: 'secondary',\n\t\t\t\t\tcallback: () => (this.closeModal()),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Set API Token',\n\t\t\t\t\ttype: 'primary',\n\t\t\t\t\tcallback: () => (this.redirect('/settings/user/b2sharebridge')),\n\t\t\t\t\thref: generateUrl('/settings/user/b2sharebridge'),\n\t\t\t\t},\n\t\t\t]\n\t\t\treturn\n\t\t}\n\n\t\tif (this.servers.length !== Object.keys(this.tokens).length) {\n\t\t\tthis.info.message = 'Number of servers and tokens differ, please contact an administrator'\n\t\t\tconsole.error(this.info.message)\n\t\t\tthis.tokens = null\n\t\t\t// this.showDialog = true\n\t\t\treturn\n\t\t}\n\n\t\tif (this.servers.length !== 0) {\n\t\t\tthis.servers.forEach((server) => {\n\t\t\t\tconst hasToken = this.tokens[server.id] !== ''\n\t\t\t\tif (hasToken) {\n\t\t\t\t\tconst serverOption = {\n\t\t\t\t\t\tid: server.id,\n\t\t\t\t\t\tlabel: server.name,\n\t\t\t\t\t}\n\t\t\t\t\tthis.serverprops.options.push(serverOption)\n\t\t\t\t\tif (this.serverprops.value === null) {\n\t\t\t\t\t\tconsole.debug('Selected server automatically')\n\t\t\t\t\t\tthis.serverprops.value = serverOption\n\t\t\t\t\t\tthis.onChangeServer() // update communities\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\t// add progress bar timer running indefinately\n\t\tsetInterval(this.updateProgressBar, 1000)\n\n\t\tthis.showDialog = true\n\t},\n\n\tmethods: {\n\t\t// API stuff\n\t\tasync loadServers() {\n\t\t\tconst urlPath\n\t\t\t\t= '/apps/b2sharebridge/servers?requesttoken='\n\t\t\t\t\t+ encodeURIComponent(OC.requestToken)\n\n\t\t\treturn axios\n\t\t\t\t.get(generateUrl(urlPath))\n\t\t\t\t.then((response) => {\n\t\t\t\t\tconsole.debug('Loaded servers:')\n\t\t\t\t\tconsole.debug(response)\n\t\t\t\t\tthis.servers = response.data\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tthis.info.message = 'Fetching B2SHARE servers failed! Please check your connection or contact an administrator!'\n\t\t\t\t\tconsole.error(this.info.message)\n\t\t\t\t\tconsole.error(error)\n\t\t\t\t})\n\t\t},\n\n\t\tasync loadCommunities() {\n\t\t\tconst urlPath\n\t\t\t\t= '/apps/b2sharebridge/gettabviewcontent?requesttoken='\n\t\t\t\t\t+ encodeURIComponent(OC.requestToken)\n\n\t\t\treturn axios\n\t\t\t\t.get(generateUrl(urlPath))\n\t\t\t\t.then((response) => {\n\t\t\t\t\tconsole.debug('Loaded communities:')\n\t\t\t\t\tconsole.debug(response)\n\t\t\t\t\tthis.communities = response.data\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tthis.info.message = 'Fetching B2SHARE communities failed! Please check your connection or contact an administrator!'\n\t\t\t\t\tconsole.error(this.info.message)\n\t\t\t\t\tconsole.error(error)\n\t\t\t\t})\n\t\t},\n\n\t\tasync loadTokens() {\n\t\t\tconst urlPath\n\t\t\t\t= '/apps/b2sharebridge/apitoken?requesttoken='\n\t\t\t\t\t+ encodeURIComponent(OC.requestToken)\n\n\t\t\treturn axios\n\t\t\t\t.get(generateUrl(urlPath))\n\t\t\t\t.then((response) => {\n\t\t\t\t\tconsole.debug('Successfully requested tokens!')\n\t\t\t\t\tconsole.debug(response.data)\n\t\t\t\t\tif (response.data) {\n\t\t\t\t\t\tthis.tokens = response.data\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.info('No token set!')\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tthis.info.message = 'Fetching tokens failed! Please check your connection or contact an administrator!'\n\t\t\t\t\tconsole.error(this.info.message)\n\t\t\t\t\tconsole.error(error)\n\t\t\t\t})\n\t\t},\n\n\t\tupdateDepositList() {\n\t\t\tif (this.serverprops?.value?.id && this.depositselectprops?.deposits?.[this.serverprops.value.id]?.hits) {\n\t\t\t\tthis.depositselectprops.options = []\n\t\t\t\tconst deposits = this.depositselectprops.deposits[this.serverprops.value.id].hits\n\t\t\t\tdeposits.forEach((deposit) => {\n\t\t\t\t\tconst depositOption = {\n\t\t\t\t\t\tid: deposit.id,\n\t\t\t\t\t\tlabel: deposit.metadata.titles?.[0]?.title ?? deposit.metadata.title,\n\t\t\t\t\t}\n\t\t\t\t\tthis.depositselectprops.options.push(depositOption)\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\n\t\t// Events\n\t\tonChangeServer() {\n\t\t\tconsole.debug('Updating community options')\n\n\t\t\t// reset communityprops\n\t\t\tthis.communityprops.options = []\n\t\t\tthis.communityprops.value = null\n\n\t\t\tif (this.serverprops.value !== null) {\n\t\t\t\t// set communities for new server\n\t\t\t\tthis.communities.forEach((community, _index) => {\n\t\t\t\t\tif (Object.hasOwn(community, 'serverId') && parseInt(community.serverId) === parseInt(this.serverprops.value.id)) {\n\t\t\t\t\t\tconst communityOption = {\n\t\t\t\t\t\t\tid: community.id,\n\t\t\t\t\t\t\tlabel: community.name,\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.communityprops.options.push(communityOption)\n\t\t\t\t\t\tif (community.name === 'EUDAT') { // TODO make this configurable\n\t\t\t\t\t\t\tconsole.debug('Automatically selected EUDAT as community')\n\t\t\t\t\t\t\tthis.communityprops.value = communityOption\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\t// update deposit list in attach mode\n\t\t\t\tthis.updateDepositList()\n\t\t\t}\n\t\t\tthis.validate()\n\t\t},\n\n\t\tonChangeMode() {\n\t\t\tconsole.debug('Updating b2share draft list')\n\n\t\t\tif (!this.depositselectprops.deposits) {\n\t\t\t\tthis.fetchAllDrafts()\n\t\t\t}\n\n\t\t\tthis.validate()\n\t\t},\n\n\t\tasync fetchAllDrafts() {\n\t\t\tconst size = 50\n\n\t\t\t/**\n\t\t\t *\n\t\t\t * @param {int} page Page number\n\t\t\t */\n\t\t\tfunction createUrl(page) {\n\t\t\t\tconst urlArr = [\n\t\t\t\t\t'/apps/b2sharebridge/publications?draft=',\n\t\t\t\t\ttrue,\n\t\t\t\t\t'&page=',\n\t\t\t\t\tpage,\n\t\t\t\t\t'&size=',\n\t\t\t\t\tsize,\n\t\t\t\t\t'&requesttoken=',\n\t\t\t\t\tencodeURIComponent(OC.requestToken),\n\t\t\t\t]\n\t\t\t\treturn generateUrl(urlArr.join(''))\n\t\t\t}\n\n\t\t\t// catch the first result and calculate if more are needed\n\t\t\tconst depositData = {}\n\t\t\ttry {\n\t\t\t\tconst firstRes = await axios.get(createUrl(1))\n\t\t\t\tconst servers = Object.keys(firstRes.data)\n\t\t\t\tlet totalNumber = 0\n\t\t\t\tfor (const server of servers) {\n\t\t\t\t\tconst total = firstRes.data[server].total\n\t\t\t\t\tif (total > totalNumber) {\n\t\t\t\t\t\ttotalNumber = total\n\t\t\t\t\t}\n\t\t\t\t\tconst serverData = {\n\t\t\t\t\t\thits: firstRes.data[server].records.hits,\n\t\t\t\t\t\ttotal,\n\t\t\t\t\t}\n\t\t\t\t\tdepositData[server] = serverData\n\t\t\t\t}\n\n\t\t\t\t// catch other results\n\t\t\t\tif (totalNumber > size) {\n\t\t\t\t\t// promises\n\t\t\t\t\tconst requests = []\n\t\t\t\t\tfor (let page = 2; (page - 1) * size < totalNumber; page++) {\n\t\t\t\t\t\trequests.push(axios.get(createUrl(page)))\n\t\t\t\t\t}\n\n\t\t\t\t\tconst responses = await Promise.all(requests)\n\n\t\t\t\t\t// append missing deposits\n\t\t\t\t\tfor (const res of responses) {\n\t\t\t\t\t\tfor (const server of servers) {\n\t\t\t\t\t\t\tdepositData[server].hits.push(...res.data[server].records.hits)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (_error) {\n\t\t\t\tconsole.error('Could not fetch deposits')\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// save results\n\t\t\tthis.depositselectprops.deposits = depositData\n\n\t\t\t// update deposit list\n\t\t\tthis.updateDepositList()\n\t\t},\n\n\t\thasValidTokens() {\n\t\t\tif (this.tokens === null) {\n\t\t\t\treturn false\n\t\t\t}\n\t\t\tlet validTokenFound = false\n\t\t\tObject.keys(this.tokens).forEach((key) => {\n\t\t\t\tif (this.tokens[key] !== '') {\n\t\t\t\t\tvalidTokenFound = true\n\t\t\t\t}\n\t\t\t})\n\t\t\treturn validTokenFound\n\t\t},\n\n\t\tvalidate(_event) {\n\t\t\tlet isValid = true\n\t\t\tthis.title.error = false\n\t\t\tthis.title.helpertext = ''\n\t\t\tthis.serverprops.error = false\n\t\t\tthis.communityprops.error = false\n\t\t\tthis.modeprops.error = false\n\t\t\tthis.depositselectprops.error = false\n\n\t\t\t// run checks\n\t\t\t// check server\n\t\t\tif (this.serverprops.value === null) {\n\t\t\t\tisValid = false\n\t\t\t\tif (this.publish.pressedOnce) {\n\t\t\t\t\tthis.serverprops.error = true\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// check mode\n\t\t\tif (this.modeprops.value === null) {\n\t\t\t\tisValid = false\n\t\t\t\tif (this.publish.pressedOnce) {\n\t\t\t\t\tthis.modeprops.error = true\n\t\t\t\t}\n\t\t\t} else if (this.modeprops.value.id === 'attach') {\n\t\t\t\t// mode attach: check deposit selected\n\t\t\t\tif (this.depositselectprops.value === null) {\n\t\t\t\t\tisValid = false\n\t\t\t\t\tif (this.publish.pressedOnce) {\n\t\t\t\t\t\tthis.depositselectprops.error = true\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (this.modeprops.value.id === 'create') {\n\t\t\t\t// mode create: check community\n\t\t\t\tif (this.communityprops.value === null) {\n\t\t\t\t\tisValid = false\n\t\t\t\t\tif (this.publish.pressedOnce) {\n\t\t\t\t\t\tthis.communityprops.error = true\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// mode create: check title\n\t\t\t\tif (this.title.text.length <= 3 || this.title.text.length > 128) {\n\t\t\t\t\tisValid = false\n\t\t\t\t\tthis.title.success = false\n\t\t\t\t\tif (this.publish.pressedOnce) {\n\t\t\t\t\t\t// Note both can be false\n\t\t\t\t\t\tthis.title.error = true\n\t\t\t\t\t\tthis.title.helpertext = 'Please set a title with a length between 3 and 128 characters'\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.title.error = false\n\t\t\t\t\tthis.title.success = true\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Change publishable with validation\n\t\t\tthis.publish.disabled = !isValid\n\t\t\treturn isValid\n\t\t},\n\n\t\tasync createDeposit() {\n\t\t\t// validate inputs only after first press\n\t\t\tthis.publish.pressedOnce = true\n\t\t\tif (!this.validate()) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tif (!this.selectedFiles.length) {\n\t\t\t\tconsole.error('No files selected')\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// update progress bar\n\t\t\tthis.publish.publishTime = Date.now()\n\t\t\tthis.publish.publishing = true\n\n\t\t\tlet url = ''\n\t\t\tlet props = {}\n\t\t\tif (this.modeprops.value.id === 'attach') {\n\t\t\t\t/* const draft = this.getCurrentDraft() */\n\t\t\t\turl = '/apps/b2sharebridge/attach'\n\t\t\t\tprops = {\n\t\t\t\t\tids: this.selectedFiles,\n\t\t\t\t\tdraftId: this.depositselectprops.value.id,\n\t\t\t\t\tserver_id: this.serverprops.value.id,\n\t\t\t\t}\n\t\t\t} else if (this.modeprops.value.id === 'create') {\n\t\t\t\turl = '/apps/b2sharebridge/publish'\n\t\t\t\tprops = {\n\t\t\t\t\tids: this.selectedFiles,\n\t\t\t\t\tcommunity: this.communityprops.value.id,\n\t\t\t\t\topen_access: this.openAccess,\n\t\t\t\t\ttitle: this.title.text,\n\t\t\t\t\tserver_id: this.serverprops.value.id,\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn\n\t\t\t}\n\t\t\taxios\n\t\t\t\t.post(\n\t\t\t\t\tgenerateUrl(url),\n\t\t\t\t\tprops,\n\t\t\t\t)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tconsole.debug(response)\n\t\t\t\t\tthis.info.heading = 'Transferring to B2SHARE'\n\t\t\t\t\tthis.info.message = response.data.message\n\t\t\t\t\tthis.info.buttons = [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'Ok',\n\t\t\t\t\t\t\ttype: 'secondary',\n\t\t\t\t\t\t\tcallback: () => (this.closeModal()),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'Show Deposit',\n\t\t\t\t\t\t\ttype: 'primary',\n\t\t\t\t\t\t\tcallback: () => (this.redirect('/apps/b2sharebridge/?uploads')),\n\t\t\t\t\t\t\thref: generateUrl('/apps/b2sharebridge/?uploads'),\n\t\t\t\t\t\t},\n\t\t\t\t\t]\n\t\t\t\t\tthis.publish.publishing = false\n\t\t\t\t\tthis.publish.publishTime = null\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tif (error.response) {\n\t\t\t\t\t\tif (error.response.status === 413) { // entity too large\n\t\t\t\t\t\t\tthis.info.message = 'Publishing failed! One or more of your files are too large!'\n\t\t\t\t\t\t} else if (error.response.status === 429) { // too many uploads\n\t\t\t\t\t\t\tthis.info.message = 'Publishing failed! You have too many pending uploads, please try again later!'\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.info.message = 'Publishing failed! Please check your connection or contact an administrator!'\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconsole.error(this.info.message)\n\t\t\t\t\t}\n\t\t\t\t\tconsole.error(error)\n\t\t\t\t\tthis.publish.publishing = false\n\t\t\t\t\tthis.publish.publishTime = null\n\t\t\t\t})\n\t\t},\n\n\t\tcloseModal() {\n\t\t\tthis.showDialog = false\n\t\t\tthis.info.message = ''\n\t\t},\n\n\t\tupdateProgressBar() {\n\t\t\tif (!this.publish.publishTime) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tconst seconds = (Date.now() - this.publish.publishTime) / 1000.0\n\t\t\tconsole.debug(seconds)\n\t\t\tthis.progress = Math.max(Math.min(Math.round(seconds * 20), 99), 10)\n\t\t},\n\n\t\tgetPublishLabel() {\n\t\t\tif (!this.modeprops.value || this.modeprops.value.id === 'create') {\n\t\t\t\treturn 'Publish'\n\t\t\t} else if (this.modeprops.value.id === 'attach') {\n\t\t\t\treturn 'Attach'\n\t\t\t} else {\n\t\t\t\tconsole.error('Unknown mode, please tell an administrator')\n\t\t\t\treturn 'Unknown'\n\t\t\t}\n\t\t},\n\n\t\tredirect(url) {\n\t\t\tthis.$router.push(generateUrl(url))\n\t\t},\n\n\t\t/* getCurrentDraft() {\n\t\t\tif (this.serverprops.value && this.depositselectprops.value) {\n\t\t\t\treturn this.depositselectprops.deposits[this.serverprops.value.id].hits.find((deposit) => deposit.id === this.depositselectprops.value.id)\n\t\t\t}\n\t\t\treturn null\n\t\t}, */\n\t},\n}\n</script>\n\n<style>\n#bridgedial {\n\tmin-width: 60%;\n}\n\n#bridgedial .select {\n\twidth: 100%;\n}\n\n#bridgedial .modal__content,\n#infodial .modal__content {\n\tmargin: 50px;\n}\n\n#bridgedial .modal__content h2,\n#infodial .modal__content h2 {\n\ttext-align: center;\n}\n\n#bridgedial .form-group,\n#infodial .form-group {\n\tmargin: calc(var(--default-grid-baseline) * 4) 0;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: flex-start;\n}\n\n#bridgedial .button-container,\n#infodial .button-container {\n\tdisplay: flex;\n\tflex-direction: row;\n\talign-items: start;\n\tjustify-content: flex-end;\n}\n\n#bridgedial .selecterror div {\n\tborder-color: red;\n}\n\n#infodial a {\n\tborder-radius: var(--border-radius-pill);\n}\n</style>\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/dist/stylePostLoader.js!../../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[11].use[0]!./BridgeDialog.vue?vue&type=style&index=0&id=05cd7f71&lang=css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/dist/stylePostLoader.js!../../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[11].use[0]!./BridgeDialog.vue?vue&type=style&index=0&id=05cd7f71&lang=css\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render } from \"./BridgeDialog.vue?vue&type=template&id=05cd7f71\"\nimport script from \"./BridgeDialog.vue?vue&type=script&lang=js\"\nexport * from \"./BridgeDialog.vue?vue&type=script&lang=js\"\n\nimport \"./BridgeDialog.vue?vue&type=style&index=0&id=05cd7f71&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { FileAction, FileType, Permission } from '@nextcloud/files'\nimport { spawnDialog } from '@nextcloud/vue/functions/dialog'\nimport BridgeDialog from '../components/BridgeDialog.vue'\n\n/**\n * Spawn nextcloud dialog for b2sharebridge\n *\n * @param {[Node]} nodes File Nodes, each node is for one file\n */\nasync function filepicker(nodes) {\n\tconst FileIds = nodes.map((node) => node.fileid)\n\tconsole.debug(FileIds)\n\tspawnDialog(BridgeDialog, { selectedFiles: FileIds })\n\treturn true\n}\n\nexport const action = new FileAction({\n\tid: 'b2sharebridge-action',\n\n\ttitle(_nodes) {\n\t\treturn 'B2SharebridgeFileActionTitle'\n\t},\n\n\t// Empty string when rendered inline\n\tdisplayName: () => 'B2SHARE',\n\n\ticonSvgInline: () => '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M6.5 20Q4.22 20 2.61 18.43 1 16.85 1 14.58 1 12.63 2.17 11.1 3.35 9.57 5.25 9.15 5.88 6.85 7.75 5.43 9.63 4 12 4 14.93 4 16.96 6.04 19 8.07 19 11 20.73 11.2 21.86 12.5 23 13.78 23 15.5 23 17.38 21.69 18.69 20.38 20 18.5 20H13Q12.18 20 11.59 19.41 11 18.83 11 18V12.85L9.4 14.4L8 13L12 9L16 13L14.6 14.4L13 12.85V18H18.5Q19.55 18 20.27 17.27 21 16.55 21 15.5 21 14.45 20.27 13.73 19.55 13 18.5 13H17V11Q17 8.93 15.54 7.46 14.08 6 12 6 9.93 6 8.46 7.46 7 8.93 7 11H6.5Q5.05 11 4.03 12.03 3 13.05 3 14.5 3 15.95 4.03 17 5.05 18 6.5 18H9V20M12 13Z\" /></svg>',\n\n\tenabled(nodes) {\n\t\tif (nodes.length) {\n\t\t\treturn !nodes.some((node) => node.type === FileType.Folder) && nodes.every((node) => node.permissions !== Permission.NONE)\n\t\t}\n\t\treturn false\n\t},\n\n\tasync exec(node, _view, _dir) {\n\t\tawait filepicker([node])\n\t\treturn null\n\t},\n\n\tasync execBatch(nodes, _view, _dir) {\n\t\tawait filepicker(nodes)\n\t\treturn Promise.all(nodes.map((_node) => null)) // return null for every node duh\n\t},\n\n\tinline: () => false,\n\n\torder: -51,\n})\n","import { registerFileAction } from '@nextcloud/files'\nimport { generateFilePath } from '@nextcloud/router'\nimport { action } from './actions/B2sharebridgeTabOpenAction.js'\nimport { t, n } from '@nextcloud/l10n'\n\n__webpack_nonce__ = btoa(OC.requestToken)\n__webpack_public_path__ = generateFilePath('b2sharebridge', '', 'js/')\n__webpack_require__.p = OC.filePath('b2sharebridge', 'js', '../build/'); // put your own app id and build path here.\nconst script = document.querySelector('[nonce]');\n__webpack_require__.nc = script.nonce || script.getAttribute('nonce');\n\n\nregisterFileAction(action)\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","// The chunk loading function for additional chunks\n// Since all referenced chunks are already included\n// in this file, this function is empty here.\n__webpack_require__.e = () => (Promise.resolve());","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.j = \"filetabmain\";","__webpack_require__.p = \"/apps/b2sharebridge/js/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t\"filetabmain\": 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkb2sharebridge\"] = self[\"webpackChunkb2sharebridge\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","__webpack_require__.nc = undefined;","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [\"vendors\"], () => (__webpack_require__(224)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["deferred","___CSS_LOADER_EXPORT___","push","module","id","class","name","components","NcModal","NcTextField","NcSelect","NcCheckboxRadioSwitch","NcButton","NcProgressBar","PencilIcon","props","selectedFiles","type","Array","required","data","showDialog","publish","disabled","publishing","publishTime","pressedOnce","title","success","error","text","helpertext","serverprops","inputLabel","options","value","modeprops","label","depositselectprops","deposits","communityprops","openAccess","info","heading","message","buttons","callback","this","closeModal","tokens","servers","progress","mounted","serverPromise","loadServers","communityPromise","loadCommunities","tokenPromise","loadTokens","hasValidTokens","length","Object","keys","console","forEach","server","serverOption","debug","onChangeServer","setInterval","updateProgressBar","redirect","href","generateUrl","methods","urlPath","encodeURIComponent","OC","requestToken","axios","get","then","response","catch","communities","updateDepositList","hits","deposit","depositOption","metadata","titles","community","_index","hasOwn","parseInt","serverId","communityOption","validate","onChangeMode","fetchAllDrafts","createUrl","page","urlArr","join","depositData","firstRes","totalNumber","total","serverData","records","requests","responses","Promise","all","res","_error","validTokenFound","key","_event","isValid","createDeposit","Date","now","url","ids","draftId","server_id","open_access","post","status","seconds","Math","max","min","round","getPublishLabel","$router","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","locals","$data","_createBlock","_component_NcModal","_createElementVNode","_hoisted_1","_toDisplayString","_hoisted_2","_createElementBlock","_Fragment","_renderList","button","_component_NcButton","onClick","_hoisted_3","_createVNode","_component_NcSelect","_mergeProps","$event","$options","selecterror","_component_NcTextField","placeholder","minlength","maxlength","_component_PencilIcon","size","_component_NcCheckboxRadioSwitch","_cache","_hoisted_4","variant","_component_NcProgressBar","async","filepicker","nodes","FileIds","map","node","fileid","spawnDialog","BridgeDialog","action","FileAction","_nodes","displayName","iconSvgInline","enabled","some","FileType","Folder","every","permissions","Permission","NONE","exec","_view","_dir","execBatch","_node","inline","order","__webpack_nonce__","btoa","__webpack_public_path__","generateFilePath","__webpack_require__","p","filePath","script","document","querySelector","nc","nonce","getAttribute","registerFileAction","__webpack_module_cache__","moduleId","cachedModule","undefined","exports","__webpack_modules__","call","m","O","result","chunkIds","fn","priority","notFulfilled","Infinity","i","fulfilled","j","splice","r","n","getter","__esModule","d","a","definition","o","defineProperty","enumerable","e","resolve","g","globalThis","Function","window","obj","prop","prototype","hasOwnProperty","Symbol","toStringTag","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","bind","__webpack_exports__"],"sourceRoot":""}