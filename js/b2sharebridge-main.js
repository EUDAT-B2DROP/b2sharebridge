(()=>{"use strict";var e,n={5650(t,e,n){n.d(e,{A:()=>i});var a=n(1354),r=n.n(a),s=n(6314),o=n.n(s)()(r());o.push([t.id,".pagebuttons[data-v-22c9711c]{display:flex;flex-direction:row;justify-content:flex-end;align-items:center}.pagebuttons__right[data-v-22c9711c]{border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}.pagebuttons__left[data-v-22c9711c]{border-top-right-radius:0 !important;border-bottom-right-radius:0 !important}.pagebuttons__middle[data-v-22c9711c]{border-radius:0 !important}","",{version:3,sources:["webpack://./src/components/PageButtons.vue"],names:[],mappings:"AACA,8BACI,YAAA,CACA,kBAAA,CACA,wBAAA,CACA,kBAAA,CAEA,qCACI,mCAAA,CACA,sCAAA,CAGJ,oCACI,oCAAA,CACA,uCAAA,CAGJ,sCACI,0BAAA",sourcesContent:["\n.pagebuttons {\n    display: flex;\n    flex-direction: row;\n    justify-content: flex-end;\n    align-items: center;\n\n    &__right {\n        border-top-left-radius: 0 !important;\n        border-bottom-left-radius: 0 !important;\n    }\n\n    &__left {\n        border-top-right-radius: 0 !important;\n        border-bottom-right-radius: 0 !important;\n    }\n\n    &__middle {\n        border-radius: 0 !important;\n    }\n}\n"],sourceRoot:""}]);const i=o},5701(t,e,n){n.d(e,{A:()=>i});var a=n(1354),r=n.n(a),s=n(6314),o=n.n(s)()(r());o.push([t.id,".rp[data-v-5b7b38e1]{margin:10px}.rp__selectors__top[data-v-5b7b38e1],.rp__selectors__bottom[data-v-5b7b38e1]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.rp__selectors__select[data-v-5b7b38e1]{display:flex;flex-direction:row;justify-content:flex-end;align-items:center;gap:10px}.rp__selectors__top[data-v-5b7b38e1]{border-bottom:1px solid var(--color-border)}.rp__records__record[data-v-5b7b38e1]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin-top:5px;padding-bottom:5px;border-bottom:1px solid var(--color-border)}.rp__records__record__title[data-v-5b7b38e1]{font-weight:bold}.rp__records__record__title[data-v-5b7b38e1],.rp__records__record__date[data-v-5b7b38e1]{margin-inline:5px}.rp__records__record__info[data-v-5b7b38e1]{flex-direction:column}.rp__records__record__buttons[data-v-5b7b38e1]{margin-inline-end:5px;gap:2px;display:flex;flex-direction:row}.rp__records__none[data-v-5b7b38e1]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;margin:auto}.rp__modal__download[data-v-5b7b38e1],.rp__modal__delete[data-v-5b7b38e1],.rp__modal__version[data-v-5b7b38e1]{display:flex;flex-direction:column;align-items:center;justify-content:center}.rp__modal__download__buttons[data-v-5b7b38e1],.rp__modal__delete__buttons[data-v-5b7b38e1],.rp__modal__version__buttons[data-v-5b7b38e1]{width:100%;min-height:100px;display:flex;flex-direction:row;align-items:center;justify-content:center}.rp__modal__download__devdesc[data-v-5b7b38e1],.rp__modal__delete__devdesc[data-v-5b7b38e1],.rp__modal__version__devdesc[data-v-5b7b38e1]{font-size:8px}","",{version:3,sources:["webpack://./src/components/RecordsPages.vue"],names:[],mappings:"AACA,qBACC,WAAA,CAIC,6EAEC,YAAA,CACA,kBAAA,CACA,6BAAA,CACA,kBAAA,CAGD,wCACC,YAAA,CACA,kBAAA,CACA,wBAAA,CACA,kBAAA,CACA,QAAA,CAGD,qCACC,2CAAA,CAKD,sCACC,YAAA,CACA,kBAAA,CACA,6BAAA,CACA,kBAAA,CACA,cAAA,CACA,kBAAA,CACA,2CAAA,CAEA,6CACC,gBAAA,CAGD,yFAEC,iBAAA,CAGD,4CACC,qBAAA,CAGD,+CACC,qBAAA,CACA,OAAA,CACA,YAAA,CACA,kBAAA,CAIF,oCACC,YAAA,CACA,qBAAA,CACA,kBAAA,CACA,sBAAA,CACA,iBAAA,CACA,WAAA,CAMD,+GAGC,YAAA,CACA,qBAAA,CACA,kBAAA,CACA,sBAAA,CAEA,0IACC,UAAA,CACA,gBAAA,CAEA,YAAA,CACA,kBAAA,CACA,kBAAA,CACA,sBAAA,CAGD,0IACC,aAAA",sourcesContent:["\n.rp {\n\tmargin: 10px;\n\n\t&__selectors {\n\n\t\t&__top,\n\t\t&__bottom {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: row;\n\t\t\tjustify-content: space-between;\n\t\t\talign-items: center;\n\t\t}\n\n\t\t&__select {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: row;\n\t\t\tjustify-content: flex-end;\n\t\t\talign-items: center;\n\t\t\tgap: 10px;\n\t\t}\n\n\t\t&__top {\n\t\t\tborder-bottom: 1px solid var(--color-border);\n\t\t}\n\t}\n\n\t&__records {\n\t\t&__record {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: row;\n\t\t\tjustify-content: space-between;\n\t\t\talign-items: center;\n\t\t\tmargin-top: 5px;\n\t\t\tpadding-bottom: 5px;\n\t\t\tborder-bottom: 1px solid var(--color-border);\n\n\t\t\t&__title {\n\t\t\t\tfont-weight: bold;\n\t\t\t}\n\n\t\t\t&__title,\n\t\t\t&__date {\n\t\t\t\tmargin-inline: 5px;\n\t\t\t}\n\n\t\t\t&__info {\n\t\t\t\tflex-direction: column;\n\t\t\t}\n\n\t\t\t&__buttons {\n\t\t\t\tmargin-inline-end: 5px;\n\t\t\t\tgap: 2px;\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-direction: row;\n\t\t\t}\n\t\t}\n\n\t\t&__none {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\talign-items: center;\n\t\t\tjustify-content: center;\n\t\t\ttext-align: center;\n\t\t\tmargin: auto;\n\t\t}\n\t}\n\n\t&__modal {\n\n\t\t&__download,\n\t\t&__delete,\n\t\t&__version {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\talign-items: center;\n\t\t\tjustify-content: center;\n\n\t\t\t&__buttons {\n\t\t\t\twidth: 100%;\n\t\t\t\tmin-height: 100px;\n\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-direction: row;\n\t\t\t\talign-items: center;\n\t\t\t\tjustify-content: center;\n\t\t\t}\n\n\t\t\t&__devdesc {\n\t\t\t\tfont-size: 8px;\n\t\t\t}\n\t\t}\n\n\t}\n}\n"],sourceRoot:""}]);const i=o},7235(t,e,n){n.d(e,{A:()=>g});var a=n(1354),r=n.n(a),s=n(6314),o=n.n(s),i=n(4417),l=n.n(i),d=new URL(n(1099),n.b),c=new URL(n(784),n.b),u=new URL(n(5388),n.b),p=o()(r()),A=l()(d),b=l()(c),h=l()(u);p.push([t.id,`\n#upload-table-name,\n#records-pages-name {\n\theight: 50px;\n}\n#app-content>div {\n\twidth: 100%;\n\theight: 100%;\n\tpadding: 20px;\n\tdisplay: flex;\n\tflex-direction: column;\n\tflex-grow: 1;\n\tbackground-color: var(--color-main-background)\n}\n#bridgecontent .icon-file {\n\theight: 50px;\n}\n#Upload-table {\n\twidth: 100%;\n\tborder-top: 0;\n\tborder-bottom: 0;\n}\n#bridgecontent td,\n#bridgecontent th {\n\tcolor: var(--color-main-text);\n\tborder-color: var(--color-border);\n}\nbody .table.b-table>tfoot>tr>[aria-sort=none],\nbody .table.b-table>thead>tr>th[aria-sort=none] {\n\tbackground-image: url(${A}) !important;\n}\nbody .table.b-table>tfoot>tr>[aria-sort=ascending],\nbody .table.b-table>thead>tr>th[aria-sort=ascending] {\n\tbackground-image: url(${b}) !important;\n}\nbody .table.b-table.table-dark>tfoot>tr>[aria-sort=descending],\nbody #app .table.b-table.table-dark>thead>tr>[aria-sort=descending],\n.table.b-table>.thead-dark>tr>[aria-sort=descending] {\n\tbackground-image: url(${h}) !important;\n}\ninput[type='text'] {\n\twidth: 100%;\n}\ntextarea {\n\tflex-grow: 1;\n\twidth: 100%;\n}\n.columnWidthInt {\n\twidth: 6%;\n}\n.columnWidthDate {\n\twidth: 15%;\n}\n.columnWidthTitle {\n\twidth: 20%;\n}\n.bridgelink {\n\twidth: 30%;\n}\n.bridgelink a {\n\tcolor: blue;\n}\n.bridgelink a:hover {\n\ttext-decoration: underline;\n}\n.bridgelink a:visited {\n\tcolor: purple;\n}\n`,"",{version:3,sources:["webpack://./src/App.vue"],names:[],mappings:";AAqcA;;CAEC,YAAY;AACb;AAEA;CACC,WAAW;CACX,YAAY;CACZ,aAAa;CACb,aAAa;CACb,sBAAsB;CACtB,YAAY;CACZ;AACD;AAEA;CACC,YAAY;AACb;AAEA;CACC,WAAW;CACX,aAAa;CACb,gBAAgB;AACjB;AAEA;;CAEC,6BAA6B;CAC7B,iCAAiC;AAClC;AAEA;;CAEC,oEAAkU;AACnU;AAEA;;CAEC,oEAAqT;AACtT;AAEA;;;CAGC,oEAAqT;AACtT;AAEA;CACC,WAAW;AACZ;AAEA;CACC,YAAY;CACZ,WAAW;AACZ;AAEA;CACC,SAAS;AACV;AAEA;CACC,UAAU;AACX;AAEA;CACC,UAAU;AACX;AAEA;CACC,UAAU;AACX;AAEA;CACC,WAAW;AACZ;AAEA;CACC,0BAA0B;AAC3B;AAEA;CACC,aAAa;AACd",sourcesContent:["<template>\n\t<NcContent id=\"bridgecontent\" app-name=\"b2sharebridge\" class=\"app-b2sharebridge\">\n\t\t<NcAppNavigation>\n\t\t\t<NcAppNavigationNew\n\t\t\t\tv-if=\"!loading\"\n\t\t\t\t:text=\"t('b2sharebridge', 'Publications')\"\n\t\t\t\t:disabled=\"currentState === BridgeState.RECORDS_PUBLISHED\"\n\t\t\t\tbutton-id=\"records-published\"\n\t\t\t\tbutton-class=\"icon-add\"\n\t\t\t\t@click=\"showRecordsPublished\" />\n\t\t\t<NcAppNavigationNew\n\t\t\t\tv-if=\"!loading\"\n\t\t\t\t:text=\"t('b2sharebridge', 'Drafts')\"\n\t\t\t\t:disabled=\"currentState === BridgeState.RECORDS_DRAFT\"\n\t\t\t\tbutton-id=\"records-published\"\n\t\t\t\tbutton-class=\"icon-add\"\n\t\t\t\t@click=\"showRecordsDrafted\" />\n\t\t\t<NcAppNavigationNew\n\t\t\t\tv-if=\"!loading\"\n\t\t\t\t:text=\"t('b2sharebridge', 'All Uploads')\"\n\t\t\t\t:disabled=\"currentState === BridgeState.UPLOAD_ALL\"\n\t\t\t\tbutton-id=\"upload-all-button\"\n\t\t\t\tbutton-class=\"icon-add\"\n\t\t\t\t@click=\"showAllUploads\" />\n\t\t\t<NcAppNavigationNew\n\t\t\t\tv-if=\"!loading\"\n\t\t\t\t:text=\"t('b2sharebridge', 'Pending Uploads')\"\n\t\t\t\t:disabled=\"currentState === BridgeState.UPLOAD_PENDING\"\n\t\t\t\tbutton-id=\"upload-pending-button\"\n\t\t\t\tbutton-class=\"icon-add\"\n\t\t\t\t@click=\"showPendingUploads\" />\n\t\t\t<NcAppNavigationNew\n\t\t\t\tv-if=\"!loading\"\n\t\t\t\t:text=\"t('b2sharebridge', 'Published Uploads')\"\n\t\t\t\t:disabled=\"currentState === BridgeState.UPLOAD_PUBLISHED\"\n\t\t\t\tbutton-id=\"upload-published-button\"\n\t\t\t\tbutton-class=\"icon-add\"\n\t\t\t\t@click=\"showPublishedUploads\" />\n\t\t\t<NcAppNavigationNew\n\t\t\t\tv-if=\"!loading\"\n\t\t\t\t:text=\"t('b2sharebridge', 'Failed Uploads')\"\n\t\t\t\t:disabled=\"currentState === BridgeState.UPLOAD_FAILED\"\n\t\t\t\tbutton-id=\"upload-failed-button\"\n\t\t\t\tbutton-class=\"icon-add\"\n\t\t\t\t@click=\"showFailedUploads\" />\n\t\t</NcAppNavigation>\n\t\t<NcAppContent>\n\t\t\t<div v-if=\"Uploads.length === 0 && isUpload()\">\n\t\t\t\t<div v-if=\"currentState === BridgeState.UPLOAD_ALL\">\n\t\t\t\t\t<h2 style=\"text-align: center;\">\n\t\t\t\t\t\t{{ t('b2sharebridge', 'Create an Upload to get started!') }}\n\t\t\t\t\t</h2>\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if=\"currentState === BridgeState.UPLOAD_PENDING\">\n\t\t\t\t\t<h2 style=\"text-align: center;\">\n\t\t\t\t\t\t{{ t('b2sharebridge', 'No pending Uploads!') }}\n\t\t\t\t\t</h2>\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if=\"currentState === BridgeState.UPLOAD_PUBLISHED\">\n\t\t\t\t\t<h2 style=\"text-align: center;\">\n\t\t\t\t\t\t{{ t('b2sharebridge', 'No published Uploads!') }}\n\t\t\t\t\t</h2>\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if=\"currentState === BridgeState.UPLOAD_FAILED\">\n\t\t\t\t\t<h2 style=\"text-align: center;\">\n\t\t\t\t\t\t{{ t('b2sharebridge', 'No failed Uploads!') }}\n\t\t\t\t\t</h2>\n\t\t\t\t</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t<h2 style=\"text-align: center;\">\n\t\t\t\t\t\t{{ t('b2sharebridge', 'Unknown table status!') }}\n\t\t\t\t\t</h2>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-else-if=\"isUpload()\">\n\t\t\t\t<h2 id=\"upload-table-name\" style=\"text-align: center;\">\n\t\t\t\t\t{{ getTableName() }}\n\t\t\t\t</h2>\n\t\t\t\t<SortableTable\n\t\t\t\t\tid=\"upload-table\"\n\t\t\t\t\tstriped\n\t\t\t\t\thover\n\t\t\t\t\t:rows=\"Uploads\"\n\t\t\t\t\t:fields=\"fields\"\n\t\t\t\t\tsort-by=\"createdAt\"\n\t\t\t\t\tsort-dir=\"desc\" />\n\t\t\t</div>\n\t\t\t<div v-else-if=\"!loadedPublications\">\n\t\t\t\t<h2 v-if=\"currentState === BridgeState.RECORDS_PUBLISHED\" style=\"text-align: center;\">\n\t\t\t\t\t{{ t('b2sharebridge', 'Loading publicationsÂ â€¦') }}\n\t\t\t\t</h2>\n\t\t\t\t<h2 v-if=\"currentState === BridgeState.RECORDS_DRAFT\" style=\"text-align: center;\">\n\t\t\t\t\t{{ t('b2sharebridge', 'Loading draftsÂ â€¦') }}\n\t\t\t\t</h2>\n\t\t\t</div>\n\t\t\t<div v-else-if=\"Publications.length === 0\">\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"currentState === BridgeState.RECORDS_PUBLISHED || currentState === BridgeState.RECORDS_DRAFT\">\n\t\t\t\t\t<h2 style=\"text-align: center;\">\n\t\t\t\t\t\t{{ t('b2sharebridge', 'Missing API Token') }}\n\t\t\t\t\t</h2>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<p>Please set a valid API token</p>\n\t\t\t\t\t\t<NcButton\n\t\t\t\t\t\t\tlabel=\"Set API Token\"\n\t\t\t\t\t\t\t:href=\"getSettingsUrl()\"\n\t\t\t\t\t\t\ttype=\"Primary\"\n\t\t\t\t\t\t\tarea-label=\"Set API Token\"\n\t\t\t\t\t\t\t@click=\"redirect('/settings/user/b2sharebridge')\">\n\t\t\t\t\t\t\t\"Set API Token\"\n\t\t\t\t\t\t</NcButton>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-else>\n\t\t\t\t<h2 id=\"records-pages-name\" style=\"text-align: center;\">\n\t\t\t\t\t{{ getTableName() }}\n\t\t\t\t</h2>\n\t\t\t\t<RecordsPages\n\t\t\t\t\tv-if=\"Publications\"\n\t\t\t\t\tid=\"records-pages\"\n\t\t\t\t\t:records=\"Publications\"\n\t\t\t\t\t:draft=\"currentState === BridgeState.RECORDS_DRAFT\"\n\t\t\t\t\t:page=\"page\"\n\t\t\t\t\t:page-size=\"pageSize\"\n\t\t\t\t\t:server-id=\"serverId\"\n\t\t\t\t\t@page-update=\"updatePage\"\n\t\t\t\t\t@page-size-update=\"updatePageSize\"\n\t\t\t\t\t@refresh=\"refreshRecords\"\n\t\t\t\t\t@status=\"setBridgeState\"\n\t\t\t\t\t@server-update=\"serverUpdate\" />\n\t\t\t</div>\n\t\t</NcAppContent>\n\t</NcContent>\n</template>\n\n<script>\nimport axios from '@nextcloud/axios'\nimport { showError } from '@nextcloud/dialogs'\nimport { generateUrl } from '@nextcloud/router'\n// import NcActionButton from '@nextcloud/vue/dist/Components/ActionButton.cjs'\nimport NcAppContent from '@nextcloud/vue/components/NcAppContent'\nimport NcAppNavigation from '@nextcloud/vue/components/NcAppNavigation'\nimport NcAppNavigationNew from '@nextcloud/vue/components/NcAppNavigationNew'\nimport NcButton from '@nextcloud/vue/components/NcButton'\nimport NcContent from '@nextcloud/vue/components/NcContent'\nimport RecordsPages from './components/RecordsPages.vue'\nimport SortableTable from './components/SortableTable.vue'\n\nconst BridgeState = {\n\tUPLOAD_ALL: 'all',\n\tUPLOAD_PENDING: 'pending',\n\tUPLOAD_PUBLISHED: 'published',\n\tUPLOAD_FAILED: 'failed',\n\tRECORDS_PUBLISHED: 'records_published',\n\tRECORDS_DRAFT: 'records_draft',\n}\n\nconst UploadFields = [\n\t'status',\n\t'title',\n\t'url',\n\t'owner',\n\t'error',\n\t'serverId',\n\t'fileCount',\n\t'createdAt',\n\t'updatedAt',\n]\n\nexport default {\n\tname: 'App',\n\tcomponents: {\n\t\tNcContent,\n\t\tNcAppContent,\n\t\tNcAppNavigation,\n\t\tNcAppNavigationNew,\n\t\tNcButton,\n\t\tSortableTable,\n\t\tRecordsPages,\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tUploads: [],\n\t\t\tfields: [],\n\t\t\tsortBy: 'createdAt',\n\t\t\tsortDesc: true,\n\t\t\tupdating: false,\n\t\t\tloading: true,\n\t\t\tcurrentState: BridgeState.RECORDS_PUBLISHED,\n\t\t\ttimer: null,\n\t\t\tlastUploadUpdate: null,\n\t\t\tBridgeState, // https://stackoverflow.com/questions/57538539/how-to-use-enums-or-const-in-vuejs\n\t\t\tUploadFields,\n\t\t\tPublications: null,\n\t\t\tloadedPublications: false,\n\t\t\tpageSize: 10,\n\t\t\tpage: 0,\n\t\t\tserverId: null,\n\t\t}\n\t},\n\n\t/**\n\t * Fetch list of Uploads when the component is loaded\n\t */\n\tasync mounted() {\n\t\tconst urlParams = new URLSearchParams(window.location.search)\n\t\tif (urlParams.has('uploads')) {\n\t\t\tthis.currentState = BridgeState.UPLOAD_ALL\n\t\t} else if (urlParams.has('publications')) {\n\t\t\tthis.currentState = BridgeState.RECORDS_PUBLISHED\n\t\t} else if (urlParams.has('drafts')) {\n\t\t\tthis.currentState = BridgeState.RECORDS_DRAFT\n\t\t}\n\t\tif (this.currentState === BridgeState.RECORDS_DRAFT || this.currentState === BridgeState.RECORDS_PUBLISHED) {\n\t\t\ttry {\n\t\t\t\tawait this.loadPublications(this.currentState)\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e)\n\t\t\t\tshowError(t('b2sharebridge', 'Could not fetch Records'))\n\t\t\t}\n\t\t} else {\n\t\t\ttry {\n\t\t\t\tawait this.showAllUploads()\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e)\n\t\t\t\tshowError(t('b2sharebridge', 'Could not fetch Uploads'))\n\t\t\t}\n\t\t}\n\t\tthis.loading = false\n\t},\n\n\tbeforeUnmount() { // might need to switch to beforeUnmount in the future\n\t\tclearInterval(this.timer)\n\t},\n\n\tmethods: {\n\t\tasync loadUploads(filter) {\n\t\t\tif (this.currentState === BridgeState.RECORDS_DRAFT || this.currentState === BridgeState.RECORDS_PUBLISHED) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tif (this.timer !== null) {\n\t\t\t\tclearInterval(this.timer)\n\t\t\t}\n\t\t\tthis.timer = setInterval(() => {\n\t\t\t\tthis.checkUploadUpdate()\n\t\t\t}, 1000 * 60 * 2) // every two minutes\n\t\t\tthis.lastUploadUpdate = new Date()\n\t\t\treturn axios\n\t\t\t\t.get(generateUrl('/apps/b2sharebridge/uploads?filter=' + filter))\n\t\t\t\t.then((response) => {\n\t\t\t\t\tconsole.debug(response.data)\n\t\t\t\t\tthis.Uploads = response.data\n\t\t\t\t\tthis.Uploads.forEach((value, index, array) => {\n\t\t\t\t\t\tarray[index] = this.translateUploadstatus(value)\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tconsole.error(error)\n\t\t\t\t\tconsole.error('Could not load Upload List')\n\t\t\t\t})\n\t\t},\n\n\t\tasync loadPublications(state) {\n\t\t\tthis.loadedPublications = false\n\t\t\tconst draft = state !== BridgeState.RECORDS_PUBLISHED\n\t\t\tconst urlArr = [\n\t\t\t\t'/apps/b2sharebridge/publications?draft=',\n\t\t\t\tdraft,\n\t\t\t\t'&page=',\n\t\t\t\tthis.page + 1,\n\t\t\t\t'&size=',\n\t\t\t\tthis.pageSize,\n\t\t\t]\n\t\t\tconsole.debug('URL: ' + urlArr.join(''))\n\t\t\treturn axios\n\t\t\t\t.get(generateUrl(urlArr.join('')))\n\t\t\t\t.then((response) => {\n\t\t\t\t\tconsole.debug('Publication data:')\n\t\t\t\t\tconsole.debug(this.Publications)\n\t\t\t\t\tthis.Publications = response.data\n\t\t\t\t\tthis.loadedPublications = true\n\t\t\t\t\t// TODO maybe change layout of data\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tconsole.error(error)\n\t\t\t\t\tconsole.error('Could not load Publications')\n\t\t\t\t})\n\t\t},\n\n\t\tshowAllUploads() {\n\t\t\tthis.currentState = BridgeState.UPLOAD_ALL\n\t\t\tthis.generateTableFields(['status', 'title', 'url', 'fileCount', 'serverId', 'createdAt', 'updatedAt'])\n\t\t\treturn this.loadUploads(this.currentState)\n\t\t},\n\n\t\tshowPendingUploads() {\n\t\t\tthis.currentState = BridgeState.UPLOAD_PENDING\n\t\t\tthis.generateTableFields(['title', 'fileCount', 'serverId', 'createdAt', 'updatedAt'])\n\t\t\treturn this.loadUploads(this.currentState)\n\t\t},\n\n\t\tshowPublishedUploads() {\n\t\t\tthis.currentState = BridgeState.UPLOAD_PUBLISHED\n\t\t\tthis.generateTableFields(['title', 'url', 'fileCount', 'serverId', 'createdAt', 'updatedAt'])\n\t\t\treturn this.loadUploads(this.currentState)\n\t\t},\n\n\t\tshowFailedUploads() {\n\t\t\tthis.currentState = BridgeState.UPLOAD_FAILED\n\t\t\tthis.generateTableFields(['title', 'fileCount', 'serverId', 'error', 'createdAt', 'updatedAt'])\n\t\t\treturn this.loadUploads(this.currentState)\n\t\t},\n\n\t\tshowRecordsPublished() {\n\t\t\tthis.currentState = BridgeState.RECORDS_PUBLISHED\n\t\t\treturn this.loadPublications(this.currentState)\n\t\t},\n\n\t\tshowRecordsDrafted() {\n\t\t\tthis.currentState = BridgeState.RECORDS_DRAFT\n\t\t\treturn this.loadPublications(this.currentState)\n\t\t},\n\n\t\tgetTableName() {\n\t\t\tswitch (this.currentState) {\n\t\t\t\tcase BridgeState.UPLOAD_ALL:\n\t\t\t\t\treturn 'All Uploads'\n\t\t\t\tcase BridgeState.UPLOAD_PENDING:\n\t\t\t\t\treturn 'Pending Uploads'\n\t\t\t\tcase BridgeState.UPLOAD_PUBLISHED:\n\t\t\t\t\treturn 'Published Uploads'\n\t\t\t\tcase BridgeState.UPLOAD_FAILED:\n\t\t\t\t\treturn 'Failed Uploads'\n\t\t\t\tcase BridgeState.RECORDS_PUBLISHED:\n\t\t\t\t\treturn 'Published Records'\n\t\t\t\tcase BridgeState.RECORDS_DRAFT:\n\t\t\t\t\treturn 'Drafted Records'\n\t\t\t\tdefault:\n\t\t\t\t\treturn 'Error Table'\n\t\t\t}\n\t\t},\n\n\t\tcapitalizeFirstLetter(string) {\n\t\t\treturn string.charAt(0).toUpperCase() + string.slice(1)\n\t\t},\n\n\t\ttranslateUploadstatus(Uploadstatus) {\n\t\t\tif ('status' in Uploadstatus) {\n\t\t\t\tswitch (Uploadstatus.status) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\tUploadstatus.status = this.capitalizeFirstLetter(BridgeState.UPLOAD_PUBLISHED)\n\t\t\t\t\t\tbreak\n\t\t\t\t\tcase 1:\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tUploadstatus.status = this.capitalizeFirstLetter(BridgeState.UPLOAD_PENDING)\n\t\t\t\t\t\tbreak\n\t\t\t\t\tcase 3:\n\t\t\t\t\tcase 4:\n\t\t\t\t\tcase 5:\n\t\t\t\t\t\tUploadstatus.status = this.capitalizeFirstLetter(BridgeState.UPLOAD_FAILED)\n\t\t\t\t\t\tbreak\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t\t// TODO query server id?\n\n\t\t\treturn Uploadstatus\n\t\t},\n\n\t\tcheckUploadUpdate() {\n\t\t\tconsole.debug('Polling Uploads')\n\t\t\tthis.loadUploads(this.currentState) // try to fetch update after transfer handler\n\t\t},\n\n\t\tgenerateTableFields(activeFieldNames) {\n\t\t\tthis.fields = []\n\t\t\tfor (let i = 0; i < this.UploadFields.length; i++) {\n\t\t\t\tconst originalField = UploadFields[i]\n\t\t\t\tconst field = {\n\t\t\t\t\tname: this.capitalizeFirstLetter(originalField),\n\t\t\t\t\tlabel: originalField,\n\t\t\t\t\ttype: originalField === 'url' ? 'link' : null,\n\t\t\t\t\tactive: activeFieldNames.includes(originalField),\n\t\t\t\t\textraClass: this.getExtraClass(originalField),\n\t\t\t\t}\n\t\t\t\tthis.fields.push(field)\n\t\t\t}\n\t\t},\n\n\t\tgetExtraClass(fieldName) {\n\t\t\tlet extraClass = 'columnWidthInt'\n\t\t\tswitch (fieldName) {\n\t\t\t\tcase 'url':\n\t\t\t\t\textraClass = 'bridgelink'\n\t\t\t\t\tbreak\n\t\t\t\tcase 'title':\n\t\t\t\t\textraClass = 'columnWidthTitle'\n\t\t\t\t\tbreak\n\t\t\t\tcase 'createdAt':\n\t\t\t\tcase 'updatedAt':\n\t\t\t\t\textraClass = 'columnWidthDate'\n\t\t\t\t\tbreak\n\t\t\t\tdefault: extraClass = 'columnWidthInt'\n\t\t\t}\n\t\t\treturn extraClass\n\t\t},\n\n\t\tisUpload() {\n\t\t\treturn this.currentState !== BridgeState.RECORDS_DRAFT && this.currentState !== BridgeState.RECORDS_PUBLISHED\n\t\t},\n\n\t\tupdatePage(page) {\n\t\t\tthis.page = page\n\t\t\tconsole.debug('page updated: ' + this.page)\n\t\t\tthis.loadPublications(this.currentState)\n\t\t},\n\n\t\tupdatePageSize(size) {\n\t\t\tthis.page = 0\n\t\t\tthis.pageSize = size\n\t\t\tconsole.debug('size updated: ' + this.pageSize)\n\t\t\tthis.loadPublications(this.currentState)\n\t\t},\n\n\t\trefreshRecords() {\n\t\t\tthis.updatePageSize(this.pageSize)\n\t\t},\n\n\t\tsetBridgeState(event) {\n\t\t\tif (event === 'draft') {\n\t\t\t\tthis.currentState = BridgeState.RECORDS_DRAFT\n\t\t\t} else {\n\t\t\t\tthis.currentState = BridgeState.RECORDS_PUBLISHED\n\t\t\t}\n\t\t\treturn this.loadPublications(this.currentState)\n\t\t},\n\n\t\tserverUpdate(serverId) {\n\t\t\tconsole.debug('server id updated:' + serverId)\n\t\t\tthis.serverId = serverId\n\t\t},\n\n\t\tgetSettingsUrl() {\n\t\t\treturn generateUrl('/settings/user/b2sharebridge')\n\t\t},\n\t},\n}\n<\/script>\n\n<style>\n#upload-table-name,\n#records-pages-name {\n\theight: 50px;\n}\n\n#app-content>div {\n\twidth: 100%;\n\theight: 100%;\n\tpadding: 20px;\n\tdisplay: flex;\n\tflex-direction: column;\n\tflex-grow: 1;\n\tbackground-color: var(--color-main-background)\n}\n\n#bridgecontent .icon-file {\n\theight: 50px;\n}\n\n#Upload-table {\n\twidth: 100%;\n\tborder-top: 0;\n\tborder-bottom: 0;\n}\n\n#bridgecontent td,\n#bridgecontent th {\n\tcolor: var(--color-main-text);\n\tborder-color: var(--color-border);\n}\n\nbody .table.b-table>tfoot>tr>[aria-sort=none],\nbody .table.b-table>thead>tr>th[aria-sort=none] {\n\tbackground-image: url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='101' height='101' view-box='0 0 101 101' preserveAspectRatio='none'%3e%3cpath fill='white' opacity='.3' d='M51 1l25 23 24 22H1l25-22z'/%3e%3cpath fill='white' opacity='.3' d='M51 101l25-23 24-22H1l25 22z'/%3e%3c/svg%3e\") !important;\n}\n\nbody .table.b-table>tfoot>tr>[aria-sort=ascending],\nbody .table.b-table>thead>tr>th[aria-sort=ascending] {\n\tbackground-image: url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='101' height='101' view-box='0 0 101 101' preserveAspectRatio='none'%3e%3cpath fill='white' d='M51 1l25 23 24 22H1l25-22z'/%3e%3cpath fill='white' opacity='.3' d='M51 101l25-23 24-22H1l25 22z'/%3e%3c/svg%3e\") !important;\n}\n\nbody .table.b-table.table-dark>tfoot>tr>[aria-sort=descending],\nbody #app .table.b-table.table-dark>thead>tr>[aria-sort=descending],\n.table.b-table>.thead-dark>tr>[aria-sort=descending] {\n\tbackground-image: url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='101' height='101' view-box='0 0 101 101' preserveAspectRatio='none'%3e%3cpath fill='white' opacity='.3' d='M51 1l25 23 24 22H1l25-22z'/%3e%3cpath fill='white' d='M51 101l25-23 24-22H1l25 22z'/%3e%3c/svg%3e\") !important;\n}\n\ninput[type='text'] {\n\twidth: 100%;\n}\n\ntextarea {\n\tflex-grow: 1;\n\twidth: 100%;\n}\n\n.columnWidthInt {\n\twidth: 6%;\n}\n\n.columnWidthDate {\n\twidth: 15%;\n}\n\n.columnWidthTitle {\n\twidth: 20%;\n}\n\n.bridgelink {\n\twidth: 30%;\n}\n\n.bridgelink a {\n\tcolor: blue;\n}\n\n.bridgelink a:hover {\n\ttext-decoration: underline;\n}\n\n.bridgelink a:visited {\n\tcolor: purple;\n}\n</style>\n"],sourceRoot:""}]);const g=p},7805(t,e,n){n.d(e,{A:()=>i});var a=n(1354),r=n.n(a),s=n(6314),o=n.n(s)()(r());o.push([t.id,"\n.sortable-table {\n\twidth: 100%;\n\tborder-collapse: collapse;\n}\n.sortable-table th,\n.sortable-table td {\n\tpadding: 4px;\n\tborder-inline-end: 1px solid;\n\tborder-color: var(--color-border);\n}\n.sortable-table .sortheader {\n\tdisplay: flex;\n\tflex-direction: row;\n\talign-items: center;\n\tjustify-content: space-between;\n}\n.sortable-table .sortbuttons {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n.sortable-table .sorttop {\n\tborder-bottom-left-radius: 0 !important;\n\tborder-bottom-right-radius: 0 !important;\n}\n.sortable-table .sortbottom {\n\tborder-top-left-radius: 0 !important;\n\tborder-top-right-radius: 0 !important;\n}\n.sortable-table .sortbottom,\n.sortable-table .sorttop {\n\tmin-height: 22px !important;\n\theight: 22px;\n}\n","",{version:3,sources:["webpack://./src/components/SortableTable.vue"],names:[],mappings:";AA4GA;CACC,WAAW;CACX,yBAAyB;AAC1B;AAEA;;CAEC,YAAY;CACZ,4BAA4B;CAC5B,iCAAiC;AAClC;AAEA;CACC,aAAa;CACb,mBAAmB;CACnB,mBAAmB;CACnB,8BAA8B;AAC/B;AAEA;CACC,aAAa;CACb,sBAAsB;AACvB;AAEA;CACC,uCAAuC;CACvC,wCAAwC;AAEzC;AAEA;CACC,oCAAoC;CACpC,qCAAqC;AACtC;AAEA;;CAEC,2BAA2B;CAC3B,YAAY;AACb",sourcesContent:['<template>\n\t<table class="sortable-table">\n\t\t<thead>\n\t\t\t<tr>\n\t\t\t\t<template v-for="(field, index) in fields">\n\t\t\t\t\t<th v-if="fields.at(index).active" :key="\'header-fields\' + index">\n\t\t\t\t\t\t<div class="sortheader">\n\t\t\t\t\t\t\t{{ field.name }}\n\t\t\t\t\t\t\t<span class="sortbuttons">\n\t\t\t\t\t\t\t\t<NcButton\n\t\t\t\t\t\t\t\t\tvariant="secondary"\n\t\t\t\t\t\t\t\t\taria-label="Ascending Sort"\n\t\t\t\t\t\t\t\t\tclass="sorttop"\n\t\t\t\t\t\t\t\t\t:disabled="sortBy === field.label && sortDir === \'asc\'"\n\t\t\t\t\t\t\t\t\t@click="sortByColumn(field.label, \'asc\')">\n\t\t\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t\t\t<Triangle :size="10" />\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</NcButton>\n\t\t\t\t\t\t\t\t<NcButton\n\t\t\t\t\t\t\t\t\tvariant="secondary"\n\t\t\t\t\t\t\t\t\taria-label="Descending Sort"\n\t\t\t\t\t\t\t\t\tclass="sortbottom"\n\t\t\t\t\t\t\t\t\t:disabled="sortBy === field.label && sortDir === \'desc\'"\n\t\t\t\t\t\t\t\t\t@click="sortByColumn(field.label, \'desc\')">\n\t\t\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t\t\t<TriangleDown :size="10" />\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</NcButton>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</th>\n\t\t\t\t</template>\n\t\t\t</tr>\n\t\t</thead>\n\t\t<tbody>\n\t\t\t<tr v-for="(row, index) in sortedRows" :key="\'rows\' + index">\n\t\t\t\t<template v-for="(field, findex) in fields">\n\t\t\t\t\t<td v-if="field.active" :key="\'body-fields\' + findex" :class="field.extraClass">\n\t\t\t\t\t\t<a v-if="field.type === \'link\'" :href="row[field.label]">\n\t\t\t\t\t\t\t{{ row[field.label] }}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t{{ row[field.label] }}\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</td>\n\t\t\t\t</template>\n\t\t\t</tr>\n\t\t</tbody>\n\t</table>\n</template>\n\n<script>\nimport { NcButton } from \'@nextcloud/vue\'\nimport Triangle from \'vue-material-design-icons/Triangle.vue\'\nimport TriangleDown from \'vue-material-design-icons/TriangleDown.vue\'\nexport default {\n\tname: \'SortableTable\',\n\tcomponents: {\n\t\tTriangle,\n\t\tTriangleDown,\n\t\tNcButton,\n\t},\n\n\tprops: {\n\t\tfields: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\n\t\trows: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tsortBy: \'createdAt\',\n\t\t\tsortDir: \'desc\',\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tsortedRows() {\n\t\t\tif (!this.sortBy) {\n\t\t\t\treturn this.rows\n\t\t\t}\n\t\t\tconst rowsSorted = this.rows.slice(0).sort((rowA, rowB) => {\n\t\t\t\treturn rowA[this.sortBy] > rowB[this.sortBy]\n\t\t\t})\n\t\t\tif (this.sortDir === \'desc\') {\n\t\t\t\trowsSorted.reverse()\n\t\t\t}\n\t\t\treturn rowsSorted\n\t\t},\n\t},\n\n\tmethods: {\n\t\tsortByColumn(columnName, direction) {\n\t\t\tthis.sortBy = columnName\n\t\t\tthis.sortDir = direction\n\t\t},\n\t},\n}\n<\/script>\n\n<style>\n.sortable-table {\n\twidth: 100%;\n\tborder-collapse: collapse;\n}\n\n.sortable-table th,\n.sortable-table td {\n\tpadding: 4px;\n\tborder-inline-end: 1px solid;\n\tborder-color: var(--color-border);\n}\n\n.sortable-table .sortheader {\n\tdisplay: flex;\n\tflex-direction: row;\n\talign-items: center;\n\tjustify-content: space-between;\n}\n\n.sortable-table .sortbuttons {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.sortable-table .sorttop {\n\tborder-bottom-left-radius: 0 !important;\n\tborder-bottom-right-radius: 0 !important;\n\n}\n\n.sortable-table .sortbottom {\n\tborder-top-left-radius: 0 !important;\n\tborder-top-right-radius: 0 !important;\n}\n\n.sortable-table .sortbottom,\n.sortable-table .sorttop {\n\tmin-height: 22px !important;\n\theight: 22px;\n}\n</style>\n'],sourceRoot:""}]);const i=o},784(t){t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27101%27 height=%27101%27 view-box=%270 0 101 101%27 preserveAspectRatio=%27none%27%3e%3cpath fill=%27white%27 d=%27M51 1l25 23 24 22H1l25-22z%27/%3e%3cpath fill=%27white%27 opacity=%27.3%27 d=%27M51 101l25-23 24-22H1l25 22z%27/%3e%3c/svg%3e"},5388(t){t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27101%27 height=%27101%27 view-box=%270 0 101 101%27 preserveAspectRatio=%27none%27%3e%3cpath fill=%27white%27 opacity=%27.3%27 d=%27M51 1l25 23 24 22H1l25-22z%27/%3e%3cpath fill=%27white%27 d=%27M51 101l25-23 24-22H1l25 22z%27/%3e%3c/svg%3e"},1099(t){t.exports="data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27101%27 height=%27101%27 view-box=%270 0 101 101%27 preserveAspectRatio=%27none%27%3e%3cpath fill=%27white%27 opacity=%27.3%27 d=%27M51 1l25 23 24 22H1l25-22z%27/%3e%3cpath fill=%27white%27 opacity=%27.3%27 d=%27M51 101l25-23 24-22H1l25 22z%27/%3e%3c/svg%3e"},4883(e,n,a){var r=a(3814),s=a(3751),o=a(641),i=a(33);const l={key:0},d={key:0},c={style:{"text-align":"center"}},u={key:1},p={style:{"text-align":"center"}},A={key:2},b={style:{"text-align":"center"}},h={key:3},g={style:{"text-align":"center"}},v={key:4},C={style:{"text-align":"center"}},_={key:1},m={id:"upload-table-name",style:{"text-align":"center"}},f={key:2},S={key:0,style:{"text-align":"center"}},w={key:1,style:{"text-align":"center"}},D={key:3},P={key:0},k={style:{"text-align":"center"}},y={key:4},U={id:"records-pages-name",style:{"text-align":"center"}};var B=a(6802),x=a(5168),E=a(2554),L=a(3835),R=a(6689),N=a(5446),I=a(3875);const O={class:"rp"},F={class:"rp__selectors__top"},T={class:"rp__selectors__select"},z={class:"rp__selectors__select"},W={class:"rp__records"},H=["href"],X={class:"rp__records__record__info"},j={class:"rp__records__record__title"},M={class:"rp__records__record__date"},Y={class:"rp__records__record__buttons"},V={key:0,class:"rp__records__none"},q={key:0},Q=["href"],G={key:1},$=["href"],J={key:1,class:"rp__records__none"},K=["href"],Z={class:"rp__selectors__bottom"},tt={class:"rp__modal__delete"},et={class:"rp__modal__delete__buttons"},nt={class:"rp__modal__download"},at={key:0,class:"rp__modal__download__devdesc"},rt={class:"rp__modal__version"},st={class:"rp__modal__version__buttons"};var ot=a(3598),it=a(6119),lt=a(8220),dt=a(9647),ct=a(8266);const ut={key:0,class:"pagebuttons"};var pt=a(9474),At=a(4350),bt=a(119),ht=a(8756);const gt={name:"PageButtons",components:{NcButton:ot.x1,PageFirst:bt.A,PageLast:ht.A,ChevronLeft:pt.A,ChevronRight:At.A},props:{page:{type:Number,required:!0},numPages:{type:Number,required:!0}},emits:["page-update"],computed:{isLastPage(){return this.page>=this.numPages-1},isFirstPage(){return 0===this.page}},methods:{updatePage(t){const e=this.numPages-1;let n=this.page;"+1"===t?(n+=1,n>e&&(n=e)):"-1"===t?(n-=1,n<0&&(n=0)):"first"===t?n=0:"last"===t&&(n=e),this.$emit("page-update",n)},updatePageIncrement(){this.updatePage("+1")},updatePageDecrement(){this.updatePage("-1")},updatePageFirst(){this.updatePage("first")},updatePageLast(){this.updatePage("last")}}};var vt=a(5072),Ct=a.n(vt),_t=a(7825),mt=a.n(_t),ft=a(7659),St=a.n(ft),wt=a(5056),Dt=a.n(wt),Pt=a(540),kt=a.n(Pt),yt=a(1113),Ut=a.n(yt),Bt=a(5650),xt={};xt.styleTagTransform=Ut(),xt.setAttributes=Dt(),xt.insert=St().bind(null,"head"),xt.domAPI=mt(),xt.insertStyleElement=kt();Ct()(Bt.A,xt);Bt.A&&Bt.A.locals&&Bt.A.locals;var Et=a(6262);const Lt=(0,Et.A)(gt,[["render",function(t,e,n,a,r,s){const i=(0,o.g2)("PageFirst"),l=(0,o.g2)("NcButton"),d=(0,o.g2)("ChevronLeft"),c=(0,o.g2)("ChevronRight"),u=(0,o.g2)("PageLast");return n.numPages?((0,o.uX)(),(0,o.CE)("div",ut,[(0,o.bF)(l,{class:"pagebuttons__left","aria-label":"First Page",disabled:s.isFirstPage,onClick:s.updatePageFirst},{icon:(0,o.k6)(()=>[(0,o.bF)(i,{size:20})]),_:1},8,["disabled","onClick"]),(0,o.bF)(l,{class:"pagebuttons__middle","aria-label":"Previous Page",disabled:s.isFirstPage,onClick:s.updatePageDecrement},{icon:(0,o.k6)(()=>[(0,o.bF)(d,{size:20})]),_:1},8,["disabled","onClick"]),(0,o.bF)(l,{class:"pagebuttons__middle","aria-label":"Next Page",disabled:s.isLastPage,onClick:s.updatePageIncrement},{icon:(0,o.k6)(()=>[(0,o.bF)(c,{size:20})]),_:1},8,["disabled","onClick"]),(0,o.bF)(l,{class:"pagebuttons__right","aria-label":"Last Page",disabled:s.isLastPage,onClick:s.updatePageLast},{icon:(0,o.k6)(()=>[(0,o.bF)(u,{size:20})]),_:1},8,["disabled","onClick"])])):(0,o.Q3)("",!0)}],["__scopeId","data-v-22c9711c"]]),Rt={name:"RecordsPages",components:{NcButton:ot.x1,NcSelect:ot.EQ,NcModal:ot.FH,PageButtons:Lt,CloudDownload:it.A,TrashCan:ct.A,EarthArrowUp:lt.A,Plus:dt.A},props:{records:{type:Object,required:!0},draft:{type:Boolean,required:!0},page:{type:Number,required:!0},pageSize:{type:Number,required:!0},serverId:{type:Number,required:!1,default:null}},emits:["page-size-update","page-update","server-update","refresh","status"],data(){return{sortBy:"createdAt",sortDir:"desc",selectPageSize:{options:["10","25","50"],value:String(this.pageSize)},selectedServer:{options:[],value:{id:this.serverId,label:null===this.serverId?"None":this.records[this.serverId].server_name}},modalDelete:{show:!1,record:null},modalDownload:{show:!1,record:null,title:"",code:-1},modalVersion:{show:!1,record:null,title:"",success:!0}}},computed:{},async mounted(){this.updateServerOptions()},methods:{getResultsOverview(){const t=this.getNumRecords();if(!t)return"0 results";return`${this.page*this.pageSize+1} - ${Math.min((this.page+1)*this.pageSize,t)} of ${t} results`},getRecords(){return this.selectedServer.value&&this.selectedServer.value.id?this.records[this.selectedServer.value.id].records.hits:[]},getNumRecords(){return this.selectedServer.value&&this.selectedServer.value.id?this.records[this.selectedServer.value.id].records.total:0},getHasToken(){return!(!this.selectedServer.value||!this.selectedServer.value.id)&&this.records[this.selectedServer.value.id].has_token},getNumPages(){const t=this.getNumRecords();return t?Math.floor(t/this.pageSize)+1:0},updateServer(t){this.$emit("server-update",Number(t.id))},updatePageSize(t){this.selectPageSize.value=t,this.$emit("page-size-update",Number(t))},updatePage(t){this.$emit("page-update",Number(t))},getTitle:t=>t?.metadata?.titles?.[0]?.title??t?.metadata?.title??"ERROR: no title",getDate:t=>new Date(t.created).toDateString(),getLink(t){const e=t.id,n=this.records[this.selectedServer.value.id];return 2===n.server_version?`${n.server_url}/records/${e}/edit`:`${n.server_url}/uploads/${e}`},showDeleteModal(t){this.modalDelete.record=t,this.modalDelete.show=!0},changeStatus(t){this.$emit(t)},closeModals(){this.modalDelete.show=!1,this.modalDelete.record=null,this.modalDownload.show=!1,this.modalDownload.record=null,this.modalVersion.show=!1,this.modalVersion.record=null},deleteRecord(t){const e=["/apps/b2sharebridge/drafts/",this.selectedServer.value.id,"/",t.id];B.Ay.delete((0,r.Jv)(e.join(""))).then(t=>{console.debug(t),this.$emit("refresh")}).catch(e=>{console.error(e),console.error(`Could not delete draft with ID ${t.id} from server ${this.selectedServer.value.label}`)})},nextVersion(t){const e={server_id:this.selectedServer.value.id,recordId:t.id};B.Ay.post((0,r.Jv)("/apps/b2sharebridge/next"),e).then(t=>{console.debug(t),this.modalVersion.title="New Version created!",this.modalVersion.message="Successfully created a new version. You can see it under your drafts. Would you like to switch to draft view?",this.modalVersion.success=!0,this.modalVersion.show=!0}).catch(e=>{console.error(e),console.error(`Could not create new version with ${t.id} from server ${this.selectedServer.value.label}`),this.modalVersion.title="Creating a new version failed!",this.modalVersion.message="Could not create a new version. Maybe a new version already exists",this.modalVersion.success=!1,this.modalVersion.show=!0})},downloadRecord(t){const e=["/apps/b2sharebridge/download/",this.selectedServer.value.id];B.Ay.post((0,r.Jv)(e.join("")),{record:t}).then(t=>{console.debug(t),this.modalDownload.message="Successfully downloaded your data into your home directory",this.modalDownload.title="Data ready",this.modalDownload.code=0,this.modalDownload.show=!0}).catch(e=>{console.error(e),console.error(`Could not download record with ID ${t.id} from server ${this.selectedServer.value.label}`);const n=e.response.data;429===Number(e.status)?(this.modalDownload.message="You are rate limited due to your last download(s), please come back later",this.modalDownload.code=0,this.modalDownload.title="Rate limit exceeded"):(this.modalDownload.message=n.message,"error"===n.status&&(this.modalDownload.code=n.code),n.status>=500?this.modalDownload.title="Server Error":this.modalDownload.title="Bad Request"),this.modalDownload.show=!0})},getServerUrl(){return this.selectedServer.value&&this.selectedServer.value.id?this.records[this.selectedServer.value.id].server_url:""},getServerLabel(){return this.selectedServer.value.label?this.selectedServer.value.label:"None"},updateServerOptions(){return this.selectedServer.options=[],console.debug("Keys: "+Object.keys(this.records)),Object.keys(this.records).forEach(t=>{this.selectedServer.options.push({id:t,label:this.records[t].server_name})}),this.selectedServer.options.length?(null!==this.serverId&&(this.selectedServer.value=this.selectedServer.options.find(t=>Number(t.id)===this.serverId)),this.selectedServer.value&&this.selectedServer.value.id||(this.selectedServer.value=this.selectedServer.options[0])):this.selectedServer.value={id:null,label:"None"},null!==this.selectedServer.value.id},getSettingsUrl:()=>(0,r.Jv)("/settings/user/b2sharebridge")}};var Nt=a(5701),It={};It.styleTagTransform=Ut(),It.setAttributes=Dt(),It.insert=St().bind(null,"head"),It.domAPI=mt(),It.insertStyleElement=kt();Ct()(Nt.A,It);Nt.A&&Nt.A.locals&&Nt.A.locals;const Ot=(0,Et.A)(Rt,[["render",function(t,e,n,a,r,s){const l=(0,o.g2)("NcSelect"),d=(0,o.g2)("PageButtons"),c=(0,o.g2)("Plus"),u=(0,o.g2)("NcButton"),p=(0,o.g2)("EarthArrowUp"),A=(0,o.g2)("CloudDownload"),b=(0,o.g2)("TrashCan"),h=(0,o.g2)("NcModal");return(0,o.uX)(),(0,o.CE)("div",O,[(0,o.Lk)("div",F,[(0,o.Lk)("p",null,(0,i.v_)(s.getResultsOverview()),1),(0,o.Lk)("div",T,[e[5]||(e[5]=(0,o.Lk)("p",null,"B2SHARE instance:",-1)),(0,o.bF)(l,(0,o.v6)(r.selectedServer,{modelValue:r.selectedServer.value,"onUpdate:modelValue":[e[0]||(e[0]=t=>r.selectedServer.value=t),s.updateServer],"label-outside":!0,options:r.selectedServer.options}),null,16,["modelValue","options","onUpdate:modelValue"])]),(0,o.Lk)("div",z,[e[6]||(e[6]=(0,o.Lk)("p",null,"Page Size:",-1)),(0,o.bF)(l,(0,o.v6)(r.selectPageSize,{modelValue:r.selectPageSize.value,"onUpdate:modelValue":[e[1]||(e[1]=t=>r.selectPageSize.value=t),s.updatePageSize],"label-outside":!0,options:r.selectPageSize.options}),null,16,["modelValue","options","onUpdate:modelValue"])]),(0,o.bF)(d,{class:"rp__selectors__pagebuttons",page:n.page,"num-pages":s.getNumPages(),onPageUpdate:s.updatePage},null,8,["page","num-pages","onPageUpdate"])]),(0,o.Lk)("div",W,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.getRecords(),t=>((0,o.uX)(),(0,o.CE)("div",{key:t.id,class:"rp__records__record"},[(0,o.Lk)("a",{href:s.getLink(t),target:"_blank"},[(0,o.Lk)("div",X,[(0,o.Lk)("p",j,(0,i.v_)(s.getTitle(t)),1),(0,o.Lk)("p",M,(0,i.v_)(s.getDate(t)),1)])],8,H),(0,o.Lk)("div",Y,[n.draft?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(u,{key:0,class:"rp__records__record__buttons__next","aria-label":"Create a new Version",target:"_blank",onClick:e=>s.nextVersion(t)},{icon:(0,o.k6)(()=>[(0,o.bF)(c,{size:30})]),default:(0,o.k6)(()=>[e[7]||(e[7]=(0,o.eW)(" New Version ",-1))]),_:1},8,["onClick"])),n.draft?((0,o.uX)(),(0,o.Wv)(u,{key:1,class:"rp__records__record__buttons__publish","aria-label":"publish draft to B2SHARE",href:s.getLink(t),target:"_blank"},{icon:(0,o.k6)(()=>[(0,o.bF)(p,{size:30})]),default:(0,o.k6)(()=>[e[8]||(e[8]=(0,o.eW)(" Publish ",-1))]),_:1},8,["href"])):(0,o.Q3)("",!0),(0,o.bF)(u,{class:"rp__records__record__buttons__download","aria-label":"Download B2SHARE contents to B2DROP",onClick:e=>s.downloadRecord(t)},{icon:(0,o.k6)(()=>[(0,o.bF)(A,{size:30})]),_:1},8,["onClick"]),n.draft?((0,o.uX)(),(0,o.Wv)(u,{key:2,class:"rp__records__record__buttons__delete","aria-label":"Delete Draft",onClick:e=>s.showDeleteModal(t)},{icon:(0,o.k6)(()=>[(0,o.bF)(b,{size:30})]),_:1},8,["onClick"])):(0,o.Q3)("",!0)])]))),128)),!s.getNumRecords()&&s.getHasToken()?((0,o.uX)(),(0,o.CE)("div",V,[n.draft?((0,o.uX)(),(0,o.CE)("h3",q,[e[9]||(e[9]=(0,o.eW)(" You don't have any drafts at ",-1)),(0,o.Lk)("a",{href:s.getServerUrl()},(0,i.v_)(s.getServerLabel()),9,Q)])):((0,o.uX)(),(0,o.CE)("h3",G,[e[10]||(e[10]=(0,o.eW)(" You don't have any publications at ",-1)),(0,o.Lk)("a",{href:s.getServerUrl()},(0,i.v_)(s.getServerLabel()),9,$)])),e[11]||(e[11]=(0,o.Lk)("h3",null,[(0,o.eW)(" You can upload files from B2DROP by selecting them and pressing the "),(0,o.Lk)("b",null,"B2SHARE"),(0,o.eW)(" button ðŸš€ ")],-1))])):(0,o.Q3)("",!0),s.getHasToken()?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",J,[(0,o.Lk)("h3",null,[e[12]||(e[12]=(0,o.eW)(" You don't have any (or any valid) token for ",-1)),(0,o.Lk)("a",{href:s.getServerUrl()},(0,i.v_)(s.getServerLabel()),9,K)]),(0,o.Lk)("div",null,[e[14]||(e[14]=(0,o.Lk)("p",null,"Please set a valid API token",-1)),(0,o.bF)(u,{label:"Set API Token",href:s.getSettingsUrl(),type:"Primary","area-label":"Set API Token",onClick:e[2]||(e[2]=e=>t.redirect("/settings/user/b2sharebridge"))},{default:(0,o.k6)(()=>[...e[13]||(e[13]=[(0,o.eW)(' "Set API Token" ',-1)])]),_:1},8,["href"])])]))]),(0,o.Lk)("div",Z,[(0,o.Lk)("p",null,(0,i.v_)(s.getResultsOverview()),1),(0,o.bF)(d,{class:"rp__selectors__pagebuttons",page:n.page,"num-pages":s.getNumPages(),onPageUpdate:s.updatePage},null,8,["page","num-pages","onPageUpdate"])]),r.modalDelete.show?((0,o.uX)(),(0,o.Wv)(h,{key:0,name:"DeleteModal",onClose:s.closeModals},{default:(0,o.k6)(()=>[(0,o.Lk)("div",tt,[e[17]||(e[17]=(0,o.Lk)("h2",null,"Delete Draft",-1)),(0,o.Lk)("p",null,'Are you sure you want to delete "'+(0,i.v_)(s.getTitle(r.modalDelete.record))+'"?',1),(0,o.Lk)("span",et,[(0,o.bF)(u,{"aria-label":"Cancel",onClick:s.closeModals},{default:(0,o.k6)(()=>[...e[15]||(e[15]=[(0,o.eW)(" Cancel ",-1)])]),_:1},8,["onClick"]),(0,o.bF)(u,{variant:"primary","aria-label":"Yes",onClick:e[3]||(e[3]=t=>s.deleteRecord(r.modalDelete.record))},{default:(0,o.k6)(()=>[...e[16]||(e[16]=[(0,o.eW)(" Yes ",-1)])]),_:1})])])]),_:1},8,["onClose"])):(0,o.Q3)("",!0),r.modalDownload.show?((0,o.uX)(),(0,o.Wv)(h,{key:1,name:"DownloadModal",onClose:s.closeModals},{default:(0,o.k6)(()=>[(0,o.Lk)("div",nt,[(0,o.Lk)("h2",null,(0,i.v_)(r.modalDownload.title),1),(0,o.Lk)("p",null,(0,i.v_)(r.modalDownload.message),1),0!==r.modalDownload.code?((0,o.uX)(),(0,o.CE)("p",at," (Status code for Developers: "+(0,i.v_)(r.modalDownload.code)+") ",1)):(0,o.Q3)("",!0),(0,o.bF)(u,{"aria-label":"Cancel",onClick:s.closeModals},{default:(0,o.k6)(()=>[...e[18]||(e[18]=[(0,o.eW)(" Ok ",-1)])]),_:1},8,["onClick"])])]),_:1},8,["onClose"])):(0,o.Q3)("",!0),r.modalVersion.show?((0,o.uX)(),(0,o.Wv)(h,{key:2,name:"VersionModal",onClose:s.closeModals},{default:(0,o.k6)(()=>[(0,o.Lk)("div",rt,[(0,o.Lk)("h2",null,(0,i.v_)(r.modalVersion.title),1),(0,o.Lk)("p",null,(0,i.v_)(r.modalVersion.message),1),(0,o.Lk)("span",st,[r.modalVersion.success?((0,o.uX)(),(0,o.Wv)(u,{key:0,"aria-label":"Cancel",onClick:s.closeModals},{default:(0,o.k6)(()=>[...e[19]||(e[19]=[(0,o.eW)(" Cancel ",-1)])]),_:1},8,["onClick"])):(0,o.Q3)("",!0),r.modalVersion.success?((0,o.uX)(),(0,o.Wv)(u,{key:1,variant:"primary","aria-label":"Yes",onClick:e[4]||(e[4]=t=>s.changeStatus("draft"))},{default:(0,o.k6)(()=>[...e[20]||(e[20]=[(0,o.eW)(" Ok ",-1)])]),_:1})):((0,o.uX)(),(0,o.Wv)(u,{key:2,variant:"primary","aria-label":"Yes",onClick:s.closeModals},{default:(0,o.k6)(()=>[...e[21]||(e[21]=[(0,o.eW)(" Ok ",-1)])]),_:1},8,["onClick"]))])])]),_:1},8,["onClose"])):(0,o.Q3)("",!0)])}],["__scopeId","data-v-5b7b38e1"]]),Ft={class:"sortable-table"},Tt={class:"sortheader"},zt={class:"sortbuttons"},Wt=["href"];var Ht=a(9303),Xt=a(7679);const jt={name:"SortableTable",components:{Triangle:Ht.A,TriangleDown:Xt.A,NcButton:ot.x1},props:{fields:{type:Array,required:!0},rows:{type:Array,required:!0}},data:()=>({sortBy:"createdAt",sortDir:"desc"}),computed:{sortedRows(){if(!this.sortBy)return this.rows;const t=this.rows.slice(0).sort((t,e)=>t[this.sortBy]>e[this.sortBy]);return"desc"===this.sortDir&&t.reverse(),t}},methods:{sortByColumn(t,e){this.sortBy=t,this.sortDir=e}}};var Mt=a(7805),Yt={};Yt.styleTagTransform=Ut(),Yt.setAttributes=Dt(),Yt.insert=St().bind(null,"head"),Yt.domAPI=mt(),Yt.insertStyleElement=kt();Ct()(Mt.A,Yt);Mt.A&&Mt.A.locals&&Mt.A.locals;const Vt=(0,Et.A)(jt,[["render",function(t,e,n,a,r,s){const l=(0,o.g2)("Triangle"),d=(0,o.g2)("NcButton"),c=(0,o.g2)("TriangleDown");return(0,o.uX)(),(0,o.CE)("table",Ft,[(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.fields,(t,e)=>((0,o.uX)(),(0,o.CE)(o.FK,null,[n.fields.at(e).active?((0,o.uX)(),(0,o.CE)("th",{key:"header-fields"+e},[(0,o.Lk)("div",Tt,[(0,o.eW)((0,i.v_)(t.name)+" ",1),(0,o.Lk)("span",zt,[(0,o.bF)(d,{variant:"secondary","aria-label":"Ascending Sort",class:"sorttop",disabled:r.sortBy===t.label&&"asc"===r.sortDir,onClick:e=>s.sortByColumn(t.label,"asc")},{icon:(0,o.k6)(()=>[(0,o.bF)(l,{size:10})]),_:1},8,["disabled","onClick"]),(0,o.bF)(d,{variant:"secondary","aria-label":"Descending Sort",class:"sortbottom",disabled:r.sortBy===t.label&&"desc"===r.sortDir,onClick:e=>s.sortByColumn(t.label,"desc")},{icon:(0,o.k6)(()=>[(0,o.bF)(c,{size:10})]),_:1},8,["disabled","onClick"])])])])):(0,o.Q3)("",!0)],64))),256))])]),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.sortedRows,(t,e)=>((0,o.uX)(),(0,o.CE)("tr",{key:"rows"+e},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.fields,(e,n)=>((0,o.uX)(),(0,o.CE)(o.FK,null,[e.active?((0,o.uX)(),(0,o.CE)("td",{key:"body-fields"+n,class:(0,i.C4)(e.extraClass)},["link"===e.type?((0,o.uX)(),(0,o.CE)("a",{key:0,href:t[e.label]},(0,i.v_)(t[e.label]),9,Wt)):((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[(0,o.eW)((0,i.v_)(t[e.label]),1)],64))],2)):(0,o.Q3)("",!0)],64))),256))]))),128))])])}]]),qt={UPLOAD_ALL:"all",UPLOAD_PENDING:"pending",UPLOAD_PUBLISHED:"published",UPLOAD_FAILED:"failed",RECORDS_PUBLISHED:"records_published",RECORDS_DRAFT:"records_draft"},Qt=["status","title","url","owner","error","serverId","fileCount","createdAt","updatedAt"],Gt={name:"App",components:{NcContent:I.A,NcAppContent:E.A,NcAppNavigation:L.A,NcAppNavigationNew:R.A,NcButton:N.A,SortableTable:Vt,RecordsPages:Ot},data:()=>({Uploads:[],fields:[],sortBy:"createdAt",sortDesc:!0,updating:!1,loading:!0,currentState:qt.RECORDS_PUBLISHED,timer:null,lastUploadUpdate:null,BridgeState:qt,UploadFields:Qt,Publications:null,loadedPublications:!1,pageSize:10,page:0,serverId:null}),async mounted(){const e=new URLSearchParams(window.location.search);if(e.has("uploads")?this.currentState=qt.UPLOAD_ALL:e.has("publications")?this.currentState=qt.RECORDS_PUBLISHED:e.has("drafts")&&(this.currentState=qt.RECORDS_DRAFT),this.currentState===qt.RECORDS_DRAFT||this.currentState===qt.RECORDS_PUBLISHED)try{await this.loadPublications(this.currentState)}catch(e){console.error(e),(0,x.Qg)(t("b2sharebridge","Could not fetch Records"))}else try{await this.showAllUploads()}catch(e){console.error(e),(0,x.Qg)(t("b2sharebridge","Could not fetch Uploads"))}this.loading=!1},beforeUnmount(){clearInterval(this.timer)},methods:{async loadUploads(t){if(this.currentState!==qt.RECORDS_DRAFT&&this.currentState!==qt.RECORDS_PUBLISHED)return null!==this.timer&&clearInterval(this.timer),this.timer=setInterval(()=>{this.checkUploadUpdate()},12e4),this.lastUploadUpdate=new Date,B.Ay.get((0,r.Jv)("/apps/b2sharebridge/uploads?filter="+t)).then(t=>{console.debug(t.data),this.Uploads=t.data,this.Uploads.forEach((t,e,n)=>{n[e]=this.translateUploadstatus(t)})}).catch(t=>{console.error(t),console.error("Could not load Upload List")})},async loadPublications(t){this.loadedPublications=!1;const e=["/apps/b2sharebridge/publications?draft=",t!==qt.RECORDS_PUBLISHED,"&page=",this.page+1,"&size=",this.pageSize];return console.debug("URL: "+e.join("")),B.Ay.get((0,r.Jv)(e.join(""))).then(t=>{console.debug("Publication data:"),console.debug(this.Publications),this.Publications=t.data,this.loadedPublications=!0}).catch(t=>{console.error(t),console.error("Could not load Publications")})},showAllUploads(){return this.currentState=qt.UPLOAD_ALL,this.generateTableFields(["status","title","url","fileCount","serverId","createdAt","updatedAt"]),this.loadUploads(this.currentState)},showPendingUploads(){return this.currentState=qt.UPLOAD_PENDING,this.generateTableFields(["title","fileCount","serverId","createdAt","updatedAt"]),this.loadUploads(this.currentState)},showPublishedUploads(){return this.currentState=qt.UPLOAD_PUBLISHED,this.generateTableFields(["title","url","fileCount","serverId","createdAt","updatedAt"]),this.loadUploads(this.currentState)},showFailedUploads(){return this.currentState=qt.UPLOAD_FAILED,this.generateTableFields(["title","fileCount","serverId","error","createdAt","updatedAt"]),this.loadUploads(this.currentState)},showRecordsPublished(){return this.currentState=qt.RECORDS_PUBLISHED,this.loadPublications(this.currentState)},showRecordsDrafted(){return this.currentState=qt.RECORDS_DRAFT,this.loadPublications(this.currentState)},getTableName(){switch(this.currentState){case qt.UPLOAD_ALL:return"All Uploads";case qt.UPLOAD_PENDING:return"Pending Uploads";case qt.UPLOAD_PUBLISHED:return"Published Uploads";case qt.UPLOAD_FAILED:return"Failed Uploads";case qt.RECORDS_PUBLISHED:return"Published Records";case qt.RECORDS_DRAFT:return"Drafted Records";default:return"Error Table"}},capitalizeFirstLetter:t=>t.charAt(0).toUpperCase()+t.slice(1),translateUploadstatus(t){if("status"in t)switch(t.status){case 0:t.status=this.capitalizeFirstLetter(qt.UPLOAD_PUBLISHED);break;case 1:case 2:t.status=this.capitalizeFirstLetter(qt.UPLOAD_PENDING);break;case 3:case 4:case 5:t.status=this.capitalizeFirstLetter(qt.UPLOAD_FAILED)}return t},checkUploadUpdate(){console.debug("Polling Uploads"),this.loadUploads(this.currentState)},generateTableFields(t){this.fields=[];for(let e=0;e<this.UploadFields.length;e++){const n=Qt[e],a={name:this.capitalizeFirstLetter(n),label:n,type:"url"===n?"link":null,active:t.includes(n),extraClass:this.getExtraClass(n)};this.fields.push(a)}},getExtraClass(t){let e="columnWidthInt";switch(t){case"url":e="bridgelink";break;case"title":e="columnWidthTitle";break;case"createdAt":case"updatedAt":e="columnWidthDate";break;default:e="columnWidthInt"}return e},isUpload(){return this.currentState!==qt.RECORDS_DRAFT&&this.currentState!==qt.RECORDS_PUBLISHED},updatePage(t){this.page=t,console.debug("page updated: "+this.page),this.loadPublications(this.currentState)},updatePageSize(t){this.page=0,this.pageSize=t,console.debug("size updated: "+this.pageSize),this.loadPublications(this.currentState)},refreshRecords(){this.updatePageSize(this.pageSize)},setBridgeState(t){return this.currentState="draft"===t?qt.RECORDS_DRAFT:qt.RECORDS_PUBLISHED,this.loadPublications(this.currentState)},serverUpdate(t){console.debug("server id updated:"+t),this.serverId=t},getSettingsUrl:()=>(0,r.Jv)("/settings/user/b2sharebridge")}};var $t=a(7235),Jt={};Jt.styleTagTransform=Ut(),Jt.setAttributes=Dt(),Jt.insert=St().bind(null,"head"),Jt.domAPI=mt(),Jt.insertStyleElement=kt();Ct()($t.A,Jt);$t.A&&$t.A.locals&&$t.A.locals;const Kt=(0,Et.A)(Gt,[["render",function(t,e,n,a,r,s){const B=(0,o.g2)("NcAppNavigationNew"),x=(0,o.g2)("NcAppNavigation"),E=(0,o.g2)("SortableTable"),L=(0,o.g2)("NcButton"),R=(0,o.g2)("RecordsPages"),N=(0,o.g2)("NcAppContent"),I=(0,o.g2)("NcContent");return(0,o.uX)(),(0,o.Wv)(I,{id:"bridgecontent","app-name":"b2sharebridge",class:"app-b2sharebridge"},{default:(0,o.k6)(()=>[(0,o.bF)(x,null,{default:(0,o.k6)(()=>[r.loading?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(B,{key:0,text:t.t("b2sharebridge","Publications"),disabled:r.currentState===r.BridgeState.RECORDS_PUBLISHED,"button-id":"records-published","button-class":"icon-add",onClick:s.showRecordsPublished},null,8,["text","disabled","onClick"])),r.loading?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(B,{key:1,text:t.t("b2sharebridge","Drafts"),disabled:r.currentState===r.BridgeState.RECORDS_DRAFT,"button-id":"records-published","button-class":"icon-add",onClick:s.showRecordsDrafted},null,8,["text","disabled","onClick"])),r.loading?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(B,{key:2,text:t.t("b2sharebridge","All Uploads"),disabled:r.currentState===r.BridgeState.UPLOAD_ALL,"button-id":"upload-all-button","button-class":"icon-add",onClick:s.showAllUploads},null,8,["text","disabled","onClick"])),r.loading?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(B,{key:3,text:t.t("b2sharebridge","Pending Uploads"),disabled:r.currentState===r.BridgeState.UPLOAD_PENDING,"button-id":"upload-pending-button","button-class":"icon-add",onClick:s.showPendingUploads},null,8,["text","disabled","onClick"])),r.loading?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(B,{key:4,text:t.t("b2sharebridge","Published Uploads"),disabled:r.currentState===r.BridgeState.UPLOAD_PUBLISHED,"button-id":"upload-published-button","button-class":"icon-add",onClick:s.showPublishedUploads},null,8,["text","disabled","onClick"])),r.loading?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(B,{key:5,text:t.t("b2sharebridge","Failed Uploads"),disabled:r.currentState===r.BridgeState.UPLOAD_FAILED,"button-id":"upload-failed-button","button-class":"icon-add",onClick:s.showFailedUploads},null,8,["text","disabled","onClick"]))]),_:1}),(0,o.bF)(N,null,{default:(0,o.k6)(()=>[0===r.Uploads.length&&s.isUpload()?((0,o.uX)(),(0,o.CE)("div",l,[r.currentState===r.BridgeState.UPLOAD_ALL?((0,o.uX)(),(0,o.CE)("div",d,[(0,o.Lk)("h2",c,(0,i.v_)(t.t("b2sharebridge","Create an Upload to get started!")),1)])):r.currentState===r.BridgeState.UPLOAD_PENDING?((0,o.uX)(),(0,o.CE)("div",u,[(0,o.Lk)("h2",p,(0,i.v_)(t.t("b2sharebridge","No pending Uploads!")),1)])):r.currentState===r.BridgeState.UPLOAD_PUBLISHED?((0,o.uX)(),(0,o.CE)("div",A,[(0,o.Lk)("h2",b,(0,i.v_)(t.t("b2sharebridge","No published Uploads!")),1)])):r.currentState===r.BridgeState.UPLOAD_FAILED?((0,o.uX)(),(0,o.CE)("div",h,[(0,o.Lk)("h2",g,(0,i.v_)(t.t("b2sharebridge","No failed Uploads!")),1)])):((0,o.uX)(),(0,o.CE)("div",v,[(0,o.Lk)("h2",C,(0,i.v_)(t.t("b2sharebridge","Unknown table status!")),1)]))])):s.isUpload()?((0,o.uX)(),(0,o.CE)("div",_,[(0,o.Lk)("h2",m,(0,i.v_)(s.getTableName()),1),(0,o.bF)(E,{id:"upload-table",striped:"",hover:"",rows:r.Uploads,fields:r.fields,"sort-by":"createdAt","sort-dir":"desc"},null,8,["rows","fields"])])):r.loadedPublications?0===r.Publications.length?((0,o.uX)(),(0,o.CE)("div",D,[r.currentState===r.BridgeState.RECORDS_PUBLISHED||r.currentState===r.BridgeState.RECORDS_DRAFT?((0,o.uX)(),(0,o.CE)("div",P,[(0,o.Lk)("h2",k,(0,i.v_)(t.t("b2sharebridge","Missing API Token")),1),(0,o.Lk)("div",null,[e[2]||(e[2]=(0,o.Lk)("p",null,"Please set a valid API token",-1)),(0,o.bF)(L,{label:"Set API Token",href:s.getSettingsUrl(),type:"Primary","area-label":"Set API Token",onClick:e[0]||(e[0]=e=>t.redirect("/settings/user/b2sharebridge"))},{default:(0,o.k6)(()=>[...e[1]||(e[1]=[(0,o.eW)(' "Set API Token" ',-1)])]),_:1},8,["href"])])])):(0,o.Q3)("",!0)])):((0,o.uX)(),(0,o.CE)("div",y,[(0,o.Lk)("h2",U,(0,i.v_)(s.getTableName()),1),r.Publications?((0,o.uX)(),(0,o.Wv)(R,{key:0,id:"records-pages",records:r.Publications,draft:r.currentState===r.BridgeState.RECORDS_DRAFT,page:r.page,"page-size":r.pageSize,"server-id":r.serverId,onPageUpdate:s.updatePage,onPageSizeUpdate:s.updatePageSize,onRefresh:s.refreshRecords,onStatus:s.setBridgeState,onServerUpdate:s.serverUpdate},null,8,["records","draft","page","page-size","server-id","onPageUpdate","onPageSizeUpdate","onRefresh","onStatus","onServerUpdate"])):(0,o.Q3)("",!0)])):((0,o.uX)(),(0,o.CE)("div",f,[r.currentState===r.BridgeState.RECORDS_PUBLISHED?((0,o.uX)(),(0,o.CE)("h2",S,(0,i.v_)(t.t("b2sharebridge","Loading publicationsÂ â€¦")),1)):(0,o.Q3)("",!0),r.currentState===r.BridgeState.RECORDS_DRAFT?((0,o.uX)(),(0,o.CE)("h2",w,(0,i.v_)(t.t("b2sharebridge","Loading draftsÂ â€¦")),1)):(0,o.Q3)("",!0)]))]),_:1})]),_:1})}]]);var Zt=a(3334);a.nc=btoa(OC.requestToken),a.p=(0,r.fg)("b2sharebridge","","js/");const te=(0,s.Ef)(Kt);te.mixin({methods:{t:Zt.t,n:Zt.n}}),te.mount("#content")}},a={};function r(t){var e=a[t];if(void 0!==e)return e.exports;var s=a[t]={id:t,exports:{}};return n[t].call(s.exports,s,s.exports,r),s.exports}r.m=n,e=[],r.O=(t,n,a,s)=>{if(!n){var o=1/0;for(c=0;c<e.length;c++){for(var[n,a,s]=e[c],i=!0,l=0;l<n.length;l++)(!1&s||o>=s)&&Object.keys(r.O).every(t=>r.O[t](n[l]))?n.splice(l--,1):(i=!1,s<o&&(o=s));if(i){e.splice(c--,1);var d=a();void 0!==d&&(t=d)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[n,a,s]},r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.e=()=>Promise.resolve(),r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.j="main",r.p="/apps/b2sharebridge/js/",(()=>{r.b="undefined"!=typeof document&&document.baseURI||self.location.href;var t={main:0};r.O.j=e=>0===t[e];var e=(e,n)=>{var a,s,[o,i,l]=n,d=0;if(o.some(e=>0!==t[e])){for(a in i)r.o(i,a)&&(r.m[a]=i[a]);if(l)var c=l(r)}for(e&&e(n);d<o.length;d++)s=o[d],r.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return r.O(c)},n=self.webpackChunkb2sharebridge=self.webpackChunkb2sharebridge||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),r.nc=void 0;var s=r.O(void 0,["vendors"],()=>r(4883));s=r.O(s)})();
//# sourceMappingURL=b2sharebridge-main.js.map?v=0a0552b17bb2cbc24a70